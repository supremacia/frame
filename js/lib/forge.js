(function(){function c(t){var o=t.util=t.util||{};(function(){if(typeof process!=="undefined"&&process.nextTick){o.nextTick=process.nextTick;if(typeof setImmediate==="function"){o.setImmediate=setImmediate}else{o.setImmediate=o.nextTick}return}if(typeof setImmediate==="function"){o.setImmediate=setImmediate;o.nextTick=function(C){return setImmediate(C)};return}o.setImmediate=function(C){setTimeout(C,0)};if(typeof window!=="undefined"&&typeof window.postMessage==="function"){var A="forge.setImmediate";var y=[];o.setImmediate=function(C){y.push(C);if(y.length===1){window.postMessage(A,"*")}};function x(C){if(C.source===window&&C.data===A){C.stopPropagation();var D=y.slice();y.length=0;D.forEach(function(E){E()})}}window.addEventListener("message",x,true)}if(typeof MutationObserver!=="undefined"){var w=Date.now();var v=true;var B=document.createElement("div");var y=[];new MutationObserver(function(){var C=y.slice();y.length=0;C.forEach(function(D){D()})}).observe(B,{attributes:true});var z=o.setImmediate;o.setImmediate=function(C){if(Date.now()-w>15){w=Date.now();z(C)}else{y.push(C);if(y.length===1){B.setAttribute("a",v=!v)}}}}o.nextTick=o.setImmediate})();o.isArray=Array.isArray||function(v){return Object.prototype.toString.call(v)==="[object Array]"};o.isArrayBuffer=function(v){return typeof ArrayBuffer!=="undefined"&&v instanceof ArrayBuffer};o.isArrayBufferView=function(v){return v&&o.isArrayBuffer(v.buffer)&&v.byteLength!==undefined};o.ByteBuffer=k;function k(w){this.data="";this.read=0;if(typeof w==="string"){this.data=w}else{if(o.isArrayBuffer(w)||o.isArrayBufferView(w)){var v=new Uint8Array(w);try{this.data=String.fromCharCode.apply(null,v)}catch(y){for(var x=0;x<v.length;++x){this.putByte(v[x])}}}else{if(w instanceof k||(typeof w==="object"&&typeof w.data==="string"&&typeof w.read==="number")){this.data=w.data;this.read=w.read}}}this._constructedStringLength=0}o.ByteStringBuffer=k;var m=4096;o.ByteStringBuffer.prototype._optimizeConstructedString=function(v){this._constructedStringLength+=v;if(this._constructedStringLength>m){this.data.substr(0,1);this._constructedStringLength=0}};o.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};o.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};o.ByteStringBuffer.prototype.putByte=function(v){return this.putBytes(String.fromCharCode(v))};o.ByteStringBuffer.prototype.fillWithByte=function(v,x){v=String.fromCharCode(v);var w=this.data;while(x>0){if(x&1){w+=v}x>>>=1;if(x>0){v+=v}}this.data=w;this._optimizeConstructedString(x);return this};o.ByteStringBuffer.prototype.putBytes=function(v){this.data+=v;this._optimizeConstructedString(v.length);return this};o.ByteStringBuffer.prototype.putString=function(v){return this.putBytes(o.encodeUtf8(v))};o.ByteStringBuffer.prototype.putInt16=function(v){return this.putBytes(String.fromCharCode(v>>8&255)+String.fromCharCode(v&255))};o.ByteStringBuffer.prototype.putInt24=function(v){return this.putBytes(String.fromCharCode(v>>16&255)+String.fromCharCode(v>>8&255)+String.fromCharCode(v&255))};o.ByteStringBuffer.prototype.putInt32=function(v){return this.putBytes(String.fromCharCode(v>>24&255)+String.fromCharCode(v>>16&255)+String.fromCharCode(v>>8&255)+String.fromCharCode(v&255))};o.ByteStringBuffer.prototype.putInt16Le=function(v){return this.putBytes(String.fromCharCode(v&255)+String.fromCharCode(v>>8&255))};o.ByteStringBuffer.prototype.putInt24Le=function(v){return this.putBytes(String.fromCharCode(v&255)+String.fromCharCode(v>>8&255)+String.fromCharCode(v>>16&255))};o.ByteStringBuffer.prototype.putInt32Le=function(v){return this.putBytes(String.fromCharCode(v&255)+String.fromCharCode(v>>8&255)+String.fromCharCode(v>>16&255)+String.fromCharCode(v>>24&255))};o.ByteStringBuffer.prototype.putInt=function(w,x){var v="";do{x-=8;v+=String.fromCharCode((w>>x)&255)}while(x>0);return this.putBytes(v)};o.ByteStringBuffer.prototype.putSignedInt=function(v,w){if(v<0){v+=2<<(w-1)}return this.putInt(v,w)};o.ByteStringBuffer.prototype.putBuffer=function(v){return this.putBytes(v.getBytes())};o.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};o.ByteStringBuffer.prototype.getInt16=function(){var v=(this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1));this.read+=2;return v};o.ByteStringBuffer.prototype.getInt24=function(){var v=(this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2));this.read+=3;return v};o.ByteStringBuffer.prototype.getInt32=function(){var v=(this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3));this.read+=4;return v};o.ByteStringBuffer.prototype.getInt16Le=function(){var v=(this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8);this.read+=2;return v};o.ByteStringBuffer.prototype.getInt24Le=function(){var v=(this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16);this.read+=3;return v};o.ByteStringBuffer.prototype.getInt32Le=function(){var v=(this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24);this.read+=4;return v};o.ByteStringBuffer.prototype.getInt=function(w){var v=0;do{v=(v<<8)+this.data.charCodeAt(this.read++);w-=8}while(w>0);return v};o.ByteStringBuffer.prototype.getSignedInt=function(y){var w=this.getInt(y);var v=2<<(y-2);if(w>=v){w-=v<<1}return w};o.ByteStringBuffer.prototype.getBytes=function(v){var w;if(v){v=Math.min(this.length(),v);w=this.data.slice(this.read,this.read+v);this.read+=v}else{if(v===0){w=""}else{w=(this.read===0)?this.data:this.data.slice(this.read);this.clear()}}return w};o.ByteStringBuffer.prototype.bytes=function(v){return(typeof(v)==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+v))};o.ByteStringBuffer.prototype.at=function(v){return this.data.charCodeAt(this.read+v)};o.ByteStringBuffer.prototype.setAt=function(w,v){this.data=this.data.substr(0,this.read+w)+String.fromCharCode(v)+this.data.substr(this.read+w+1);return this};o.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};o.ByteStringBuffer.prototype.copy=function(){var v=o.createBuffer(this.data);v.read=this.read;return v};o.ByteStringBuffer.prototype.compact=function(){if(this.read>0){this.data=this.data.slice(this.read);this.read=0}return this};o.ByteStringBuffer.prototype.clear=function(){this.data="";this.read=0;return this};o.ByteStringBuffer.prototype.truncate=function(w){var v=Math.max(0,this.length()-w);this.data=this.data.substr(this.read,v);this.read=0;return this};o.ByteStringBuffer.prototype.toHex=function(){var x="";for(var w=this.read;w<this.data.length;++w){var v=this.data.charCodeAt(w);if(v<16){x+="0"}x+=v.toString(16)}return x};o.ByteStringBuffer.prototype.toString=function(){return o.decodeUtf8(this.bytes())};function l(w,x){x=x||{};this.read=x.readOffset||0;this.growSize=x.growSize||1024;var v=o.isArrayBuffer(w);var y=o.isArrayBufferView(w);if(v||y){if(v){this.data=new DataView(w)}else{this.data=new DataView(w.buffer,w.byteOffset,w.byteLength)}this.write=("writeOffset" in x?x.writeOffset:this.data.byteLength);return}this.data=new DataView(new ArrayBuffer(0));this.write=0;if(w!==null&&w!==undefined){this.putBytes(w)}if("writeOffset" in x){this.write=x.writeOffset}}o.DataBuffer=l;o.DataBuffer.prototype.length=function(){return this.write-this.read};o.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};o.DataBuffer.prototype.accommodate=function(v,y){if(this.length()>=v){return this}y=Math.max(y||this.growSize,v);var w=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);var x=new Uint8Array(this.length()+y);x.set(w);this.data=new DataView(x.buffer);return this};o.DataBuffer.prototype.putByte=function(v){this.accommodate(1);this.data.setUint8(this.write++,v);return this};o.DataBuffer.prototype.fillWithByte=function(v,x){this.accommodate(x);for(var w=0;w<x;++w){this.data.setUint8(v)}return this};o.DataBuffer.prototype.putBytes=function(x,y){if(o.isArrayBufferView(x)){var z=new Uint8Array(x.buffer,x.byteOffset,x.byteLength);var v=z.byteLength-z.byteOffset;this.accommodate(v);var A=new Uint8Array(this.data.buffer,this.write);A.set(z);this.write+=v;return this}if(o.isArrayBuffer(x)){var z=new Uint8Array(x);this.accommodate(z.byteLength);var A=new Uint8Array(this.data.buffer);A.set(z,this.write);this.write+=z.byteLength;return this}if(x instanceof o.DataBuffer||(typeof x==="object"&&typeof x.read==="number"&&typeof x.write==="number"&&o.isArrayBufferView(x.data))){var z=new Uint8Array(x.data.byteLength,x.read,x.length());this.accommodate(z.byteLength);var A=new Uint8Array(x.data.byteLength,this.write);A.set(z);this.write+=z.byteLength;return this}if(x instanceof o.ByteStringBuffer){x=x.data;y="binary"}y=y||"binary";if(typeof x==="string"){var w;if(y==="hex"){this.accommodate(Math.ceil(x.length/2));w=new Uint8Array(this.data.buffer,this.write);this.write+=o.binary.hex.decode(x,w,this.write);return this}if(y==="base64"){this.accommodate(Math.ceil(x.length/4)*3);w=new Uint8Array(this.data.buffer,this.write);this.write+=o.binary.base64.decode(x,w,this.write);return this}if(y==="utf8"){x=o.encodeUtf8(x);y="binary"}if(y==="binary"||y==="raw"){this.accommodate(x.length);w=new Uint8Array(this.data.buffer,this.write);this.write+=o.binary.raw.decode(w);return this}if(y==="utf16"){this.accommodate(x.length*2);w=new Uint16Array(this.data.buffer,this.write);this.write+=o.text.utf16.encode(w);return this}throw new Error("Invalid encoding: "+y)}throw Error("Invalid parameter: "+x)};o.DataBuffer.prototype.putBuffer=function(v){this.putBytes(v);v.clear();return this};o.DataBuffer.prototype.putString=function(v){return this.putBytes(v,"utf16")};o.DataBuffer.prototype.putInt16=function(v){this.accommodate(2);this.data.setInt16(this.write,v);this.write+=2;return this};o.DataBuffer.prototype.putInt24=function(v){this.accommodate(3);this.data.setInt16(this.write,v>>8&65535);this.data.setInt8(this.write,v>>16&255);this.write+=3;return this};o.DataBuffer.prototype.putInt32=function(v){this.accommodate(4);this.data.setInt32(this.write,v);this.write+=4;return this};o.DataBuffer.prototype.putInt16Le=function(v){this.accommodate(2);this.data.setInt16(this.write,v,true);this.write+=2;return this};o.DataBuffer.prototype.putInt24Le=function(v){this.accommodate(3);this.data.setInt8(this.write,v>>16&255);this.data.setInt16(this.write,v>>8&65535,true);this.write+=3;return this};o.DataBuffer.prototype.putInt32Le=function(v){this.accommodate(4);this.data.setInt32(this.write,v,true);this.write+=4;return this};o.DataBuffer.prototype.putInt=function(v,w){this.accommodate(w/8);do{w-=8;this.data.setInt8(this.write++,(v>>w)&255)}while(w>0);return this};o.DataBuffer.prototype.putSignedInt=function(v,w){this.accommodate(w/8);if(v<0){v+=2<<(w-1)}return this.putInt(v,w)};o.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};o.DataBuffer.prototype.getInt16=function(){var v=this.data.getInt16(this.read);this.read+=2;return v};o.DataBuffer.prototype.getInt24=function(){var v=(this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2));this.read+=3;return v};o.DataBuffer.prototype.getInt32=function(){var v=this.data.getInt32(this.read);this.read+=4;return v};o.DataBuffer.prototype.getInt16Le=function(){var v=this.data.getInt16(this.read,true);this.read+=2;return v};o.DataBuffer.prototype.getInt24Le=function(){var v=(this.data.getInt8(this.read)^this.data.getInt16(this.read+1,true)<<8);this.read+=3;return v};o.DataBuffer.prototype.getInt32Le=function(){var v=this.data.getInt32(this.read,true);this.read+=4;return v};o.DataBuffer.prototype.getInt=function(w){var v=0;do{v=(v<<8)+this.data.getInt8(this.read++);w-=8}while(w>0);return v};o.DataBuffer.prototype.getSignedInt=function(y){var w=this.getInt(y);var v=2<<(y-2);if(w>=v){w-=v<<1}return w};o.DataBuffer.prototype.getBytes=function(v){var w;if(v){v=Math.min(this.length(),v);w=this.data.slice(this.read,this.read+v);this.read+=v}else{if(v===0){w=""}else{w=(this.read===0)?this.data:this.data.slice(this.read);this.clear()}}return w};o.DataBuffer.prototype.bytes=function(v){return(typeof(v)==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+v))};o.DataBuffer.prototype.at=function(v){return this.data.getUint8(this.read+v)};o.DataBuffer.prototype.setAt=function(w,v){this.data.setUint8(w,v);return this};o.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};o.DataBuffer.prototype.copy=function(){return new o.DataBuffer(this)};o.DataBuffer.prototype.compact=function(){if(this.read>0){var v=new Uint8Array(this.data.buffer,this.read);var w=new Uint8Array(v.byteLength);w.set(v);this.data=new DataView(w);this.write-=this.read;this.read=0}return this};o.DataBuffer.prototype.clear=function(){this.data=new DataView(new ArrayBuffer(0));this.read=this.write=0;return this};o.DataBuffer.prototype.truncate=function(v){this.write=Math.max(0,this.length()-v);this.read=Math.min(this.read,this.write);return this};o.DataBuffer.prototype.toHex=function(){var x="";for(var w=this.read;w<this.data.byteLength;++w){var v=this.data.getUint8(w);if(v<16){x+="0"}x+=v.toString(16)}return x};o.DataBuffer.prototype.toString=function(w){var v=new Uint8Array(this.data,this.read,this.length());w=w||"utf8";if(w==="binary"||w==="raw"){return o.binary.raw.encode(v)}if(w==="hex"){return o.binary.hex.encode(v)}if(w==="base64"){return o.binary.base64.encode(v)}if(w==="utf8"){return o.text.utf8.decode(v)}if(w==="utf16"){return o.text.utf16.decode(v)}throw new Error("Invalid encoding: "+w)};o.createBuffer=function(v,w){w=w||"raw";if(v!==undefined&&w==="utf8"){v=o.encodeUtf8(v)}return new o.ByteBuffer(v)};o.fillString=function(x,w){var v="";while(w>0){if(w&1){v+=x}w>>>=1;if(w>0){x+=x}}return v};o.xorBytes=function(A,x,C){var w="";var v="";var z="";var y=0;var B=0;for(;C>0;--C,++y){v=A.charCodeAt(y)^x.charCodeAt(y);if(B>=10){w+=z;z="";B=0}z+=String.fromCharCode(v);++B}w+=z;return w};o.hexToBytes=function(w){var x="";var v=0;if(w.length&1==1){v=1;x+=String.fromCharCode(parseInt(w[0],16))}for(;v<w.length;v+=2){x+=String.fromCharCode(parseInt(w.substr(v,2),16))}return x};o.bytesToHex=function(v){return o.createBuffer(v).toHex()};o.int32ToBytes=function(v){return(String.fromCharCode(v>>24&255)+String.fromCharCode(v>>16&255)+String.fromCharCode(v>>8&255)+String.fromCharCode(v&255))};var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];o.encode64=function(y,C){var v="";var x="";var B,z,w;var A=0;while(A<y.length){B=y.charCodeAt(A++);z=y.charCodeAt(A++);w=y.charCodeAt(A++);v+=g.charAt(B>>2);v+=g.charAt(((B&3)<<4)|(z>>4));if(isNaN(z)){v+="=="}else{v+=g.charAt(((z&15)<<2)|(w>>6));v+=isNaN(w)?"=":g.charAt(w&63)}if(C&&v.length>C){x+=v.substr(0,C)+"\r\n";v=v.substr(C)}}x+=v;return x};o.decode64=function(w){w=w.replace(/[^A-Za-z0-9\+\/\=]/g,"");var v="";var B,A,z,y;var x=0;while(x<w.length){B=u[w.charCodeAt(x++)-43];A=u[w.charCodeAt(x++)-43];z=u[w.charCodeAt(x++)-43];y=u[w.charCodeAt(x++)-43];v+=String.fromCharCode((B<<2)|(A>>4));if(z!==64){v+=String.fromCharCode(((A&15)<<4)|(z>>2));if(y!==64){v+=String.fromCharCode(((z&3)<<6)|y)}}}return v};o.encodeUtf8=function(v){return unescape(encodeURIComponent(v))};o.decodeUtf8=function(v){return decodeURIComponent(escape(v))};o.binary={raw:{},hex:{},base64:{}};o.binary.raw.encode=function(v){return String.fromCharCode.apply(null,v)};o.binary.raw.decode=function(A,v,z){var x=v;if(!x){x=new Uint8Array(A.length)}z=z||0;var w=z;for(var y=0;y<A.length;++y){x[w++]=A.charCodeAt(y)}return v?(w-z):x};o.binary.hex.encode=o.bytesToHex;o.binary.hex.decode=function(z,v,A){var x=v;if(!x){x=new Uint8Array(Math.ceil(z.length/2))}A=A||0;var y=0,w=A;if(z.length&1){y=1;x[w++]=parseInt(z[0],16)}for(;y<z.length;y+=2){x[w++]=parseInt(z.substr(y,2),16)}return v?(w-A):x};o.binary.base64.encode=function(y,C){var v="";var x="";var B,z,w;var A=0;while(A<y.byteLength){B=y[A++];z=y[A++];w=y[A++];v+=g.charAt(B>>2);v+=g.charAt(((B&3)<<4)|(z>>4));if(isNaN(z)){v+="=="}else{v+=g.charAt(((z&15)<<2)|(w>>6));v+=isNaN(w)?"=":g.charAt(w&63)}if(C&&v.length>C){x+=v.substr(0,C)+"\r\n";v=v.substr(C)}}x+=v;return x};o.binary.base64.decode=function(A,v,x){var y=v;if(!y){y=new Uint8Array(Math.ceil(A.length/4)*3)}A=A.replace(/[^A-Za-z0-9\+\/\=]/g,"");x=x||0;var E,D,C,B;var z=0,w=x;while(z<A.length){E=u[A.charCodeAt(z++)-43];D=u[A.charCodeAt(z++)-43];C=u[A.charCodeAt(z++)-43];B=u[A.charCodeAt(z++)-43];y[w++]=(E<<2)|(D>>4);if(C!==64){y[w++]=((D&15)<<4)|(C>>2);if(B!==64){y[w++]=((C&3)<<6)|B}}}return v?(w-x):y.subarray(0,w)};o.text={utf8:{},utf16:{}};o.text.utf8.encode=function(A,v,z){A=o.encodeUtf8(A);var x=v;if(!x){x=new Uint8Array(A.length)}z=z||0;var w=z;for(var y=0;y<A.length;++y){x[w++]=A.charCodeAt(y)}return v?(w-z):x};o.text.utf8.decode=function(v){return o.decodeUtf8(String.fromCharCode.apply(null,v))};o.text.utf16.encode=function(C,x,B){var z=x;if(!z){z=new Uint8Array(C.length)}var v=new Uint16Array(z);B=B||0;var y=B;var w=B;for(var A=0;A<C.length;++A){v[w++]=C.charCodeAt(A);y+=2}return x?(y-B):z};o.text.utf16.decode=function(v){return String.fromCharCode.apply(null,new Uint16Array(v))};o.deflate=function(y,w,x){w=o.decode64(y.deflate(o.encode64(w)).rval);if(x){var z=2;var v=w.charCodeAt(1);if(v&32){z=6}w=w.substring(z,w.length-4)}return w};o.inflate=function(x,v,w){var y=x.inflate(o.encode64(v)).rval;return(y===null)?null:o.decode64(y)};var i=function(w,z,y){if(!w){throw new Error("WebStorage not available.")}var x;if(y===null){x=w.removeItem(z)}else{y=o.encode64(JSON.stringify(y));x=w.setItem(z,y)}if(typeof(x)!=="undefined"&&x.rval!==true){var v=new Error(x.error.message);v.id=x.error.id;v.name=x.error.name;throw v}};var n=function(w,y){if(!w){throw new Error("WebStorage not available.")}var x=w.getItem(y);if(w.init){if(x.rval===null){if(x.error){var v=new Error(x.error.message);v.id=x.error.id;v.name=x.error.name;throw v}x=null}else{x=x.rval}}if(x!==null){x=JSON.parse(o.decode64(x))}return x};var s=function(w,z,v,x){var y=n(w,z);if(y===null){y={}}y[v]=x;i(w,z,y)};var h=function(w,y,v){var x=n(w,y);if(x!==null){x=(v in x)?x[v]:null}return x};var j=function(w,A,v){var y=n(w,A);if(y!==null&&v in y){delete y[v];var x=true;for(var z in y){x=false;break}if(x){y=null}i(w,A,y)}};var q=function(v,w){i(v,w,null)};var p=function(w,A,C){var y=null;if(typeof(C)==="undefined"){C=["web","flash"]}var B;var x=false;var v=null;for(var D in C){B=C[D];try{if(B==="flash"||B==="both"){if(A[0]===null){throw new Error("Flash local storage not available.")}y=w.apply(this,A);x=(B==="flash")}if(B==="web"||B==="both"){A[0]=localStorage;y=w.apply(this,A);x=true}}catch(z){v=z}if(x){break}}if(!x){throw v}return y};o.setItem=function(x,z,w,y,v){p(s,arguments,v)};o.getItem=function(x,y,w,v){return p(h,arguments,v)};o.removeItem=function(x,y,w,v){p(j,arguments,v)};o.clearItems=function(w,x,v){p(q,arguments,v)};o.parseUrl=function(y){var x=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;x.lastIndex=0;var v=x.exec(y);var w=(v===null)?null:{full:y,scheme:v[1],host:v[2],port:v[3],path:v[4]};if(w){w.fullHost=w.host;if(w.port){if(w.port!==80&&w.scheme==="http"){w.fullHost+=":"+w.port}else{if(w.port!==443&&w.scheme==="https"){w.fullHost+=":"+w.port}}}else{if(w.scheme==="http"){w.port=80}else{if(w.scheme==="https"){w.port=443}}}w.full=w.scheme+"://"+w.fullHost}return w};var r=null;o.getQueryVariables=function(v){var x=function(B){var C={};var A=B.split("&");for(var z=0;z<A.length;z++){var E=A[z].indexOf("=");var y;var D;if(E>0){y=A[z].substring(0,E);D=A[z].substring(E+1)}else{y=A[z];D=null}if(!(y in C)){C[y]=[]}if(!(y in Object.prototype)&&D!==null){C[y].push(unescape(D))}}return C};var w;if(typeof(v)==="undefined"){if(r===null){if(typeof(window)!=="undefined"&&window.location&&window.location.search){r=x(window.location.search.substring(1))}else{r={}}}w=r}else{w=x(v)}return w};o.parseFragment=function(x){var w=x;var v="";var A=x.indexOf("?");if(A>0){w=x.substring(0,A);v=x.substring(A+1)}var z=w.split("/");if(z.length>0&&z[0]===""){z.shift()}var y=(v==="")?{}:o.getQueryVariables(v);return{pathString:w,queryString:v,path:z,query:y}};o.makeRequest=function(w){var x=o.parseFragment(w);var v={path:x.pathString,query:x.queryString,getPath:function(y){return(typeof(y)==="undefined")?x.path:x.path[y]},getQuery:function(y,z){var A;if(typeof(y)==="undefined"){A=x.query}else{A=x.query[y];if(A&&typeof(z)!=="undefined"){A=A[z]}}return A},getQueryLast:function(z,y){var B;var A=v.getQuery(z);if(A){B=A[A.length-1]}else{B=y}return B}};return v};o.makeLink=function(y,x,w){y=jQuery.isArray(y)?y.join("/"):y;var v=jQuery.param(x||{});w=w||"";return y+((v.length>0)?("?"+v):"")+((w.length>0)?("#"+w):"")};o.setPath=function(x,A,B){if(typeof(x)==="object"&&x!==null){var y=0;var w=A.length;while(y<w){var z=A[y++];if(y==w){x[z]=B}else{var v=(z in x);if(!v||(v&&typeof(x[z])!=="object")||(v&&x[z]===null)){x[z]={}}x=x[z]}}}};o.getPath=function(y,B,x){var z=0;var w=B.length;var v=true;while(v&&z<w&&typeof(y)==="object"&&y!==null){var A=B[z++];v=A in y;if(v){y=y[A]}}return(v?y:x)};o.deletePath=function(w,z){if(typeof(w)==="object"&&w!==null){var x=0;var v=z.length;while(x<v){var y=z[x++];if(x==v){delete w[y]}else{if(!(y in w)||(typeof(w[y])!=="object")||(w[y]===null)){break}w=w[y]}}}};o.isEmpty=function(v){for(var w in v){if(v.hasOwnProperty(w)){return false}}return true};o.format=function(C){var y=/%./g;var x;var w;var v=0;var B=[];var A=0;while((x=y.exec(C))){w=C.substring(A,y.lastIndex-2);if(w.length>0){B.push(w)}A=y.lastIndex;var z=x[0][1];switch(z){case"s":case"o":if(v<arguments.length){B.push(arguments[v+++1])}else{B.push("<?>")}break;case"%":B.push("%");break;default:B.push("<%"+z+"?>")}}B.push(C.substring(A));return B.join("")};o.formatNumber=function(y,w,D,x){var v=y,C=isNaN(w=Math.abs(w))?2:w;var B=D===undefined?",":D;var E=x===undefined?".":x,F=v<0?"-":"";var A=parseInt((v=Math.abs(+v||0).toFixed(C)),10)+"";var z=(A.length>3)?A.length%3:0;return F+(z?A.substr(0,z)+E:"")+A.substr(z).replace(/(\d{3})(?=\d)/g,"$1"+E)+(C?B+Math.abs(v-A).toFixed(C).slice(2):"")};o.formatSize=function(v){if(v>=1073741824){v=o.formatNumber(v/1073741824,2,".","")+" GiB"}else{if(v>=1048576){v=o.formatNumber(v/1048576,2,".","")+" MiB"}else{if(v>=1024){v=o.formatNumber(v/1024,0)+" KiB"}else{v=o.formatNumber(v,0)+" bytes"}}}return v};o.bytesFromIP=function(v){if(v.indexOf(".")!==-1){return o.bytesFromIPv4(v)}if(v.indexOf(":")!==-1){return o.bytesFromIPv6(v)}return null};o.bytesFromIPv4=function(y){y=y.split(".");if(y.length!==4){return null}var v=o.createBuffer();for(var x=0;x<y.length;++x){var w=parseInt(y[x],10);if(isNaN(w)){return null}v.putByte(w)}return v.getBytes()};o.bytesFromIPv6=function(A){var z=0;A=A.split(":").filter(function(B){if(B.length===0){++z}return true});var x=(8-A.length+z)*2;var v=o.createBuffer();for(var y=0;y<8;++y){if(!A[y]||A[y].length===0){v.fillWithByte(0,x);x=0;continue}var w=o.hexToBytes(A[y]);if(w.length<2){v.putByte(0)}v.putBytes(w)}return v.getBytes()};o.bytesToIP=function(v){if(v.length===4){return o.bytesToIPv4(v)}if(v.length===16){return o.bytesToIPv6(v)}return null};o.bytesToIPv4=function(v){if(v.length!==4){return null}var x=[];for(var w=0;w<v.length;++w){x.push(v.charCodeAt(w))}return x.join(".")};o.bytesToIPv6=function(D){if(D.length!==16){return null}var x=[];var C=[];var y=0;for(var w=0;w<D.length;w+=2){var v=o.bytesToHex(D[w]+D[w+1]);while(v[0]==="0"&&v!=="0"){v=v.substr(1)}if(v==="0"){var B=C[C.length-1];var z=x.length;if(!B||z!==B.end+1){C.push({start:z,end:z})}else{B.end=z;if((B.end-B.start)>(C[y].end-C[y].start)){y=C.length-1}}}x.push(v)}if(C.length>0){var A=C[y];if(A.end-A.start>0){x.splice(A.start,A.end-A.start+1,"");if(A.start===0){x.unshift("")}if(A.end===7){x.push("")}}}return x.join(":")};o.estimateCores=function(w,A){if(typeof w==="function"){A=w;w={}}w=w||{};if("cores" in o&&!w.update){return A(null,o.cores)}if(typeof navigator!=="undefined"&&"hardwareConcurrency" in navigator&&navigator.hardwareConcurrency>0){o.cores=navigator.hardwareConcurrency;return A(null,o.cores)}if(typeof Worker==="undefined"){o.cores=1;return A(null,o.cores)}if(typeof Blob==="undefined"){o.cores=2;return A(null,o.cores)}var v=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(D){var B=Date.now();var C=B+4;while(Date.now()<C){}self.postMessage({st:B,et:C})})}.toString(),")()"],{type:"application/javascript"}));x([],5,16);function x(B,D,C){if(D===0){var E=Math.floor(B.reduce(function(G,F){return G+F},0)/B.length);o.cores=Math.max(1,E);URL.revokeObjectURL(v);return A(null,o.cores)}y(C,function(G,F){B.push(z(C,F));x(B,D-1,C)})}function y(C,G){var B=[];var E=[];for(var D=0;D<C;++D){var F=new Worker(v);F.addEventListener("message",function(I){E.push(I.data);if(E.length===C){for(var H=0;H<C;++H){B[H].terminate()}G(null,E)}});B.push(F)}for(var D=0;D<C;++D){B[D].postMessage(D)}}function z(D,G){var H=[];for(var I=0;I<D;++I){var E=G[I];var C=H[I]=[];for(var F=0;F<D;++F){if(I===F){continue}var B=G[F];if((E.st>B.st&&E.st<B.et)||(B.st>E.st&&B.st<E.et)){C.push(F)}}}return H.reduce(function(J,K){return Math.max(J,K.length)},0)}}}var b="util";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(h){var l=h.sha256=h.sha256||{};h.md=h.md||{};h.md.algorithms=h.md.algorithms||{};h.md.sha256=h.md.algorithms.sha256=l;l.create=function(){if(!j){m()}var n=null;var q=h.util.createBuffer();var o=new Array(64);var p={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,messageLength64:[0,0]};p.start=function(){p.messageLength=0;p.messageLength64=[0,0];q=h.util.createBuffer();n={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225};return p};p.start();p.update=function(s,r){if(r==="utf8"){s=h.util.encodeUtf8(s)}p.messageLength+=s.length;p.messageLength64[0]+=(s.length/4294967296)>>>0;p.messageLength64[1]+=s.length>>>0;q.putBytes(s);g(n,o,q);if(q.read>2048||q.length()===0){q.compact()}return p};p.digest=function(){var t=h.util.createBuffer();t.putBytes(q.bytes());t.putBytes(k.substr(0,64-((p.messageLength64[1]+8)&63)));t.putInt32((p.messageLength64[0]<<3)|(p.messageLength64[0]>>>28));t.putInt32(p.messageLength64[1]<<3);var r={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4,h5:n.h5,h6:n.h6,h7:n.h7};g(r,o,t);var s=h.util.createBuffer();s.putInt32(r.h0);s.putInt32(r.h1);s.putInt32(r.h2);s.putInt32(r.h3);s.putInt32(r.h4);s.putInt32(r.h5);s.putInt32(r.h6);s.putInt32(r.h7);return s};return p};var k=null;var j=false;var i=null;function m(){k=String.fromCharCode(128);k+=h.util.fillString(String.fromCharCode(0),64);i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];j=true}function g(v,t,x){var r,q,p,o,u,n,y,H,G,F,E,D,C,B,A;var z=x.length();while(z>=64){for(y=0;y<16;++y){t[y]=x.getInt32()}for(;y<64;++y){r=t[y-2];r=((r>>>17)|(r<<15))^((r>>>19)|(r<<13))^(r>>>10);q=t[y-15];q=((q>>>7)|(q<<25))^((q>>>18)|(q<<14))^(q>>>3);t[y]=(r+t[y-7]+q+t[y-16])|0}H=v.h0;G=v.h1;F=v.h2;E=v.h3;D=v.h4;C=v.h5;B=v.h6;A=v.h7;for(y=0;y<64;++y){o=((D>>>6)|(D<<26))^((D>>>11)|(D<<21))^((D>>>25)|(D<<7));u=B^(D&(C^B));p=((H>>>2)|(H<<30))^((H>>>13)|(H<<19))^((H>>>22)|(H<<10));n=(H&G)|(F&(H^G));r=A+o+u+i[y]+t[y];q=p+n;A=B;B=C;C=D;D=(E+r)|0;E=F;F=G;G=H;H=(r+q)|0}v.h0=(v.h0+H)|0;v.h1=(v.h1+G)|0;v.h2=(v.h2+F)|0;v.h3=(v.h3+E)|0;v.h4=(v.h4+D)|0;v.h5=(v.h5+C)|0;v.h6=(v.h6+B)|0;v.h7=(v.h7+A)|0;z-=64}}}var b="sha256";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){g.cipher=g.cipher||{};g.cipher.algorithms=g.cipher.algorithms||{};g.cipher.createCipher=function(i,j){var k=i;if(typeof k==="string"){k=g.cipher.getAlgorithm(k);if(k){k=k()}}if(!k){throw new Error("Unsupported algorithm: "+i)}return new g.cipher.BlockCipher({algorithm:k,key:j,decrypt:false})};g.cipher.createDecipher=function(i,j){var k=i;if(typeof k==="string"){k=g.cipher.getAlgorithm(k);if(k){k=k()}}if(!k){throw new Error("Unsupported algorithm: "+i)}return new g.cipher.BlockCipher({algorithm:k,key:j,decrypt:true})};g.cipher.registerAlgorithm=function(j,i){j=j.toUpperCase();g.cipher.algorithms[j]=i};g.cipher.getAlgorithm=function(i){i=i.toUpperCase();if(i in g.cipher.algorithms){return g.cipher.algorithms[i]}return null};var h=g.cipher.BlockCipher=function(i){this.algorithm=i.algorithm;this.mode=this.algorithm.mode;this.blockSize=this.mode.blockSize;this._finish=false;this._input=null;this.output=null;this._op=i.decrypt?this.mode.decrypt:this.mode.encrypt;this._decrypt=i.decrypt;this.algorithm.initialize(i)};h.prototype.start=function(i){i=i||{};var k={};for(var j in i){k[j]=i[j]}k.decrypt=this._decrypt;this._finish=false;this._input=g.util.createBuffer();this.output=i.output||g.util.createBuffer();this.mode.start(k)};h.prototype.update=function(i){if(i){this._input.putBuffer(i)}while(!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish){}this._input.compact()};h.prototype.finish=function(j){if(j&&(this.mode.name==="ECB"||this.mode.name==="CBC")){this.mode.pad=function(k){return j(this.blockSize,k,false)};this.mode.unpad=function(k){return j(this.blockSize,k,true)}}var i={};i.decrypt=this._decrypt;i.overflow=this._input.length()%this.blockSize;if(!this._decrypt&&this.mode.pad){if(!this.mode.pad(this._input,i)){return false}}this._finish=true;this.update();if(this._decrypt&&this.mode.unpad){if(!this.mode.unpad(this.output,i)){return false}}if(this.mode.afterFinish){if(!this.mode.afterFinish(this.output,i)){return false}}return true}}var b="cipher";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){g.cipher=g.cipher||{};var j=g.cipher.modes=g.cipher.modes||{};j.ecb=function(l){l=l||{};this.name="ECB";this.cipher=l.cipher;this.blockSize=l.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints)};j.ecb.prototype.start=function(l){};j.ecb.prototype.encrypt=function(m,l,o){if(m.length()<this.blockSize&&!(o&&m.length()>0)){return true}for(var n=0;n<this._ints;++n){this._inBlock[n]=m.getInt32()}this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n){l.putInt32(this._outBlock[n])}};j.ecb.prototype.decrypt=function(m,l,o){if(m.length()<this.blockSize&&!(o&&m.length()>0)){return true}for(var n=0;n<this._ints;++n){this._inBlock[n]=m.getInt32()}this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n){l.putInt32(this._outBlock[n])}};j.ecb.prototype.pad=function(l,m){var n=(l.length()===this.blockSize?this.blockSize:(this.blockSize-l.length()));l.fillWithByte(n,n);return true};j.ecb.prototype.unpad=function(m,n){if(n.overflow>0){return false}var l=m.length();var o=m.at(l-1);if(o>(this.blockSize<<2)){return false}m.truncate(o);return true};j.cbc=function(l){l=l||{};this.name="CBC";this.cipher=l.cipher;this.blockSize=l.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints)};j.cbc.prototype.start=function(l){if(l.iv===null){if(!this._prev){throw new Error("Invalid IV parameter.")}this._iv=this._prev.slice(0)}else{if(!("iv" in l)){throw new Error("Invalid IV parameter.")}else{this._iv=h(l.iv);this._prev=this._iv.slice(0)}}};j.cbc.prototype.encrypt=function(m,l,o){if(m.length()<this.blockSize&&!(o&&m.length()>0)){return true}for(var n=0;n<this._ints;++n){this._inBlock[n]=this._prev[n]^m.getInt32()}this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n){l.putInt32(this._outBlock[n])}this._prev=this._outBlock};j.cbc.prototype.decrypt=function(m,l,o){if(m.length()<this.blockSize&&!(o&&m.length()>0)){return true}for(var n=0;n<this._ints;++n){this._inBlock[n]=m.getInt32()}this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n){l.putInt32(this._prev[n]^this._outBlock[n])}this._prev=this._inBlock.slice(0)};j.cbc.prototype.pad=function(l,m){var n=(l.length()===this.blockSize?this.blockSize:(this.blockSize-l.length()));l.fillWithByte(n,n);return true};j.cbc.prototype.unpad=function(m,n){if(n.overflow>0){return false}var l=m.length();var o=m.at(l-1);if(o>(this.blockSize<<2)){return false}m.truncate(o);return true};j.cfb=function(l){l=l||{};this.name="CFB";this.cipher=l.cipher;this.blockSize=l.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialBlock=new Array(this._ints);this._partialOutput=g.util.createBuffer();this._partialBytes=0};j.cfb.prototype.start=function(l){if(!("iv" in l)){throw new Error("Invalid IV parameter.")}this._iv=h(l.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0};j.cfb.prototype.encrypt=function(n,m,p){var l=n.length();if(l===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&l>=this.blockSize){for(var o=0;o<this._ints;++o){this._inBlock[o]=n.getInt32()^this._outBlock[o];m.putInt32(this._inBlock[o])}return}var q=(this.blockSize-l)%this.blockSize;if(q>0){q=this.blockSize-q}this._partialOutput.clear();for(var o=0;o<this._ints;++o){this._partialBlock[o]=n.getInt32()^this._outBlock[o];this._partialOutput.putInt32(this._partialBlock[o])}if(q>0){n.read-=this.blockSize}else{for(var o=0;o<this._ints;++o){this._inBlock[o]=this._partialBlock[o]}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(q>0&&!p){m.putBytes(this._partialOutput.getBytes(q-this._partialBytes));this._partialBytes=q;return true}m.putBytes(this._partialOutput.getBytes(l-this._partialBytes));this._partialBytes=0};j.cfb.prototype.decrypt=function(n,m,p){var l=n.length();if(l===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&l>=this.blockSize){for(var o=0;o<this._ints;++o){this._inBlock[o]=n.getInt32();m.putInt32(this._inBlock[o]^this._outBlock[o])}return}var q=(this.blockSize-l)%this.blockSize;if(q>0){q=this.blockSize-q}this._partialOutput.clear();for(var o=0;o<this._ints;++o){this._partialBlock[o]=n.getInt32();this._partialOutput.putInt32(this._partialBlock[o]^this._outBlock[o])}if(q>0){n.read-=this.blockSize}else{for(var o=0;o<this._ints;++o){this._inBlock[o]=this._partialBlock[o]}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(q>0&&!p){m.putBytes(this._partialOutput.getBytes(q-this._partialBytes));this._partialBytes=q;return true}m.putBytes(this._partialOutput.getBytes(l-this._partialBytes));this._partialBytes=0};j.ofb=function(l){l=l||{};this.name="OFB";this.cipher=l.cipher;this.blockSize=l.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialOutput=g.util.createBuffer();this._partialBytes=0};j.ofb.prototype.start=function(l){if(!("iv" in l)){throw new Error("Invalid IV parameter.")}this._iv=h(l.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0};j.ofb.prototype.encrypt=function(n,m,p){var l=n.length();if(n.length()===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&l>=this.blockSize){for(var o=0;o<this._ints;++o){m.putInt32(n.getInt32()^this._outBlock[o]);this._inBlock[o]=this._outBlock[o]}return}var q=(this.blockSize-l)%this.blockSize;if(q>0){q=this.blockSize-q}this._partialOutput.clear();for(var o=0;o<this._ints;++o){this._partialOutput.putInt32(n.getInt32()^this._outBlock[o])}if(q>0){n.read-=this.blockSize}else{for(var o=0;o<this._ints;++o){this._inBlock[o]=this._outBlock[o]}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(q>0&&!p){m.putBytes(this._partialOutput.getBytes(q-this._partialBytes));this._partialBytes=q;return true}m.putBytes(this._partialOutput.getBytes(l-this._partialBytes));this._partialBytes=0};j.ofb.prototype.decrypt=j.ofb.prototype.encrypt;j.ctr=function(l){l=l||{};this.name="CTR";this.cipher=l.cipher;this.blockSize=l.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialOutput=g.util.createBuffer();this._partialBytes=0};j.ctr.prototype.start=function(l){if(!("iv" in l)){throw new Error("Invalid IV parameter.")}this._iv=h(l.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0};j.ctr.prototype.encrypt=function(n,m,p){var l=n.length();if(l===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&l>=this.blockSize){for(var o=0;o<this._ints;++o){m.putInt32(n.getInt32()^this._outBlock[o])}}else{var q=(this.blockSize-l)%this.blockSize;if(q>0){q=this.blockSize-q}this._partialOutput.clear();for(var o=0;o<this._ints;++o){this._partialOutput.putInt32(n.getInt32()^this._outBlock[o])}if(q>0){n.read-=this.blockSize}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(q>0&&!p){m.putBytes(this._partialOutput.getBytes(q-this._partialBytes));this._partialBytes=q;return true}m.putBytes(this._partialOutput.getBytes(l-this._partialBytes));this._partialBytes=0}k(this._inBlock)};j.ctr.prototype.decrypt=j.ctr.prototype.encrypt;j.gcm=function(l){l=l||{};this.name="GCM";this.cipher=l.cipher;this.blockSize=l.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints);this._partialOutput=g.util.createBuffer();this._partialBytes=0;this._R=3774873600};j.gcm.prototype.start=function(n){if(!("iv" in n)){throw new Error("Invalid IV parameter.")}var m=g.util.createBuffer(n.iv);this._cipherLength=0;var o;if("additionalData" in n){o=g.util.createBuffer(n.additionalData)}else{o=g.util.createBuffer()}if("tagLength" in n){this._tagLength=n.tagLength}else{this._tagLength=128}this._tag=null;if(n.decrypt){this._tag=g.util.createBuffer(n.tag).getBytes();if(this._tag.length!==(this._tagLength/8)){throw new Error("Authentication tag does not match tag length.")}}this._hashBlock=new Array(this._ints);this.tag=null;this._hashSubkey=new Array(this._ints);this.cipher.encrypt([0,0,0,0],this._hashSubkey);this.componentBits=4;this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var l=m.length();if(l===12){this._j0=[m.getInt32(),m.getInt32(),m.getInt32(),1]}else{this._j0=[0,0,0,0];while(m.length()>0){this._j0=this.ghash(this._hashSubkey,this._j0,[m.getInt32(),m.getInt32(),m.getInt32(),m.getInt32()])}this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(i(l*8)))}this._inBlock=this._j0.slice(0);k(this._inBlock);this._partialBytes=0;o=g.util.createBuffer(o);this._aDataLength=i(o.length()*8);var p=o.length()%this.blockSize;if(p){o.fillWithByte(0,this.blockSize-p)}this._s=[0,0,0,0];while(o.length()>0){this._s=this.ghash(this._hashSubkey,this._s,[o.getInt32(),o.getInt32(),o.getInt32(),o.getInt32()])}};j.gcm.prototype.encrypt=function(n,m,p){var l=n.length();if(l===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&l>=this.blockSize){for(var o=0;o<this._ints;++o){m.putInt32(this._outBlock[o]^=n.getInt32())}this._cipherLength+=this.blockSize}else{var r=(this.blockSize-l)%this.blockSize;if(r>0){r=this.blockSize-r}this._partialOutput.clear();for(var o=0;o<this._ints;++o){this._partialOutput.putInt32(n.getInt32()^this._outBlock[o])}if(r===0||p){if(p){var q=l%this.blockSize;this._cipherLength+=q;this._partialOutput.truncate(this.blockSize-q)}else{this._cipherLength+=this.blockSize}for(var o=0;o<this._ints;++o){this._outBlock[o]=this._partialOutput.getInt32()}this._partialOutput.read-=this.blockSize}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(r>0&&!p){n.read-=this.blockSize;m.putBytes(this._partialOutput.getBytes(r-this._partialBytes));this._partialBytes=r;return true}m.putBytes(this._partialOutput.getBytes(l-this._partialBytes));this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock);k(this._inBlock)};j.gcm.prototype.decrypt=function(n,m,p){var l=n.length();if(l<this.blockSize&&!(p&&l>0)){return true}this.cipher.encrypt(this._inBlock,this._outBlock);k(this._inBlock);this._hashBlock[0]=n.getInt32();this._hashBlock[1]=n.getInt32();this._hashBlock[2]=n.getInt32();this._hashBlock[3]=n.getInt32();this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var o=0;o<this._ints;++o){m.putInt32(this._outBlock[o]^this._hashBlock[o])}if(l<this.blockSize){this._cipherLength+=l%this.blockSize}else{this._cipherLength+=this.blockSize}};j.gcm.prototype.afterFinish=function(m,n){var p=true;if(n.decrypt&&n.overflow){m.truncate(this.blockSize-n.overflow)}this.tag=g.util.createBuffer();var q=this._aDataLength.concat(i(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,q);var l=[];this.cipher.encrypt(this._j0,l);for(var o=0;o<this._ints;++o){this.tag.putInt32(this._s[o]^l[o])}this.tag.truncate(this.tag.length()%(this._tagLength/8));if(n.decrypt&&this.tag.bytes()!==this._tag){p=false}return p};j.gcm.prototype.multiply=function(m,q){var n=[0,0,0,0];var p=q.slice(0);for(var o=0;o<128;++o){var l=m[(o/32)|0]&(1<<(31-o%32));if(l){n[0]^=p[0];n[1]^=p[1];n[2]^=p[2];n[3]^=p[3]}this.pow(p,p)}return n};j.gcm.prototype.pow=function(l,m){var o=l[3]&1;for(var n=3;n>0;--n){m[n]=(l[n]>>>1)|((l[n-1]&1)<<31)}m[0]=l[0]>>>1;if(o){m[0]^=this._R}};j.gcm.prototype.tableMultiply=function(n){var q=[0,0,0,0];for(var p=0;p<32;++p){var m=(p/8)|0;var l=(n[m]>>>((7-(p%8))*4))&15;var o=this._m[p][l];q[0]^=o[0];q[1]^=o[1];q[2]^=o[2];q[3]^=o[3]}return q};j.gcm.prototype.ghash=function(m,n,l){n[0]^=l[0];n[1]^=l[1];n[2]^=l[2];n[3]^=l[3];return this.tableMultiply(n)};j.gcm.prototype.generateHashTable=function(r,t){var u=8/t;var o=4*u;var v=16*u;var n=new Array(v);for(var p=0;p<v;++p){var q=[0,0,0,0];var s=(p/o)|0;var l=((o-1-(p%o))*t);q[s]=(1<<(t-1))<<l;n[p]=this.generateSubHashTable(this.multiply(q,r),t)}return n};j.gcm.prototype.generateSubHashTable=function(s,t){var v=1<<t;var u=v>>>1;var o=new Array(v);o[u]=s.slice(0);var q=u>>>1;while(q>0){this.pow(o[2*q],o[q]=[]);q>>=1}q=2;while(q<u){for(var p=1;p<q;++p){var n=o[q];var l=o[p];o[q+p]=[n[0]^l[0],n[1]^l[1],n[2]^l[2],n[3]^l[3]]}q*=2}o[0]=[0,0,0,0];for(q=u+1;q<v;++q){var r=o[q^u];o[q]=[s[0]^r[0],s[1]^r[1],s[2]^r[2],s[3]^r[3]]}return o};function h(l){if(typeof l==="string"){l=g.util.createBuffer(l)}if(g.util.isArray(l)&&l.length>4){var n=l;l=g.util.createBuffer();for(var m=0;m<n.length;++m){l.putByte(n[m])}}if(!g.util.isArray(l)){l=[l.getInt32(),l.getInt32(),l.getInt32(),l.getInt32()]}return l}function k(l){l[l.length-1]=(l[l.length-1]+1)&4294967295}function i(l){return[(l/4294967296)|0,l&4294967295]}}var b="cipherModes";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){var i=g.pem=g.pem||{};i.encode=function(n,k){k=k||{};var m="-----BEGIN "+n.type+"-----\r\n";var o;if(n.procType){o={name:"Proc-Type",values:[String(n.procType.version),n.procType.type]};m+=h(o)}if(n.contentDomain){o={name:"Content-Domain",values:[n.contentDomain]};m+=h(o)}if(n.dekInfo){o={name:"DEK-Info",values:[n.dekInfo.algorithm]};if(n.dekInfo.parameters){o.values.push(n.dekInfo.parameters)}m+=h(o)}if(n.headers){for(var l=0;l<n.headers.length;++l){m+=h(n.headers[l])}}if(n.procType){m+="\r\n"}m+=g.util.encode64(n.body,k.maxline||64)+"\r\n";m+="-----END "+n.type+"-----\r\n";return m};i.decode=function(t){var q=[];var l=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g;var s=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/;var w=/\r?\n/;var r;while(true){r=l.exec(t);if(!r){break}var m={type:r[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:g.util.decode64(r[3])};q.push(m);if(!r[2]){continue}var y=r[2].split(w);var v=0;while(r&&v<y.length){var x=y[v].replace(/\s+$/,"");for(var k=v+1;k<y.length;++k){var p=y[k];if(!/\s/.test(p[0])){break}x+=p;v=k}r=x.match(s);if(r){var o={name:r[1],values:[]};var u=r[2].split(",");for(var n=0;n<u.length;++n){o.values.push(j(u[n]))}if(!m.procType){if(o.name!=="Proc-Type"){throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".')}else{if(o.values.length!==2){throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.')}}m.procType={version:u[0],type:u[1]}}else{if(!m.contentDomain&&o.name==="Content-Domain"){m.contentDomain=u[0]||""}else{if(!m.dekInfo&&o.name==="DEK-Info"){if(o.values.length===0){throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.')}m.dekInfo={algorithm:u[0],parameters:u[1]||null}}else{m.headers.push(o)}}}}++v}if(m.procType==="ENCRYPTED"&&!m.dekInfo){throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(q.length===0){throw new Error("Invalid PEM formatted message.")}return q};function h(r){var q=r.name+": ";var k=[];var m=function(t,s){return" "+s};for(var l=0;l<r.values.length;++l){k.push(r.values[l].replace(/^(\S+\r\n)/,m))}q+=k.join(",")+"\r\n";var o=0;var n=-1;for(var l=0;l<q.length;++l,++o){if(o>65&&n!==-1){var p=q[n];if(p===","){++n;q=q.substr(0,n)+"\r\n "+q.substr(n)}else{q=q.substr(0,n)+"\r\n"+p+q.substr(n+1)}o=(l-n-1);n=-1;++l}else{if(q[l]===" "||q[l]==="\t"||q[l]===","){n=l}}}return q}function j(k){return k.replace(/^\s+/,"")}}var b="pem";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(h){var g=h.asn1=h.asn1||{};g.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};g.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};g.create=function(p,m,o,n){if(h.util.isArray(n)){var l=[];for(var k=0;k<n.length;++k){if(n[k]!==undefined){l.push(n[k])}}n=l}return{tagClass:p,type:m,constructed:o,composed:o||h.util.isArray(n),value:n}};var i=g.getBerValueLength=function(k){var l=k.getByte();if(l===128){return undefined}var n;var m=l&128;if(!m){n=l}else{n=k.getInt((l&127)<<3)}return n};g.fromDer=function(A,y){if(y===undefined){y=true}if(typeof A==="string"){A=h.util.createBuffer(A)}if(A.length()<2){var w=new Error("Too few bytes to parse DER.");w.bytes=A.length();throw w}var x=A.getByte();var r=(x&192);var v=x&31;var m=i(A);if(A.length()<m){if(y){var w=new Error("Too few bytes to read ASN.1 value.");w.detail=A.length()+" < "+m;throw w}m=A.length()}var z;var p=((x&32)===32);var u=p;if(!u&&r===g.Class.UNIVERSAL&&v===g.Type.BITSTRING&&m>1){var l=A.read;var n=A.getByte();if(n===0){x=A.getByte();var o=(x&192);if(o===g.Class.UNIVERSAL||o===g.Class.CONTEXT_SPECIFIC){try{var s=i(A);u=(s===m-(A.read-l));if(u){++l;--m}}catch(t){}}}A.read=l}if(u){z=[];if(m===undefined){for(;;){if(A.bytes(2)===String.fromCharCode(0,0)){A.getBytes(2);break}z.push(g.fromDer(A,y))}}else{var k=A.length();while(m>0){z.push(g.fromDer(A,y));m-=k-A.length();k=A.length()}}}else{if(m===undefined){if(y){throw new Error("Non-constructed ASN.1 object of indefinite length.")}m=A.length()}if(v===g.Type.BMPSTRING){z="";for(var q=0;q<m;q+=2){z+=String.fromCharCode(A.getInt16())}}else{z=A.getBytes(m)}}return g.create(r,v,p,z)};g.toDer=function(q){var m=h.util.createBuffer();var n=q.tagClass|q.type;var p=h.util.createBuffer();if(q.composed){if(q.constructed){n|=32}else{p.putByte(0)}for(var o=0;o<q.value.length;++o){if(q.value[o]!==undefined){p.putBuffer(g.toDer(q.value[o]))}}}else{if(q.type===g.Type.BMPSTRING){for(var o=0;o<q.value.length;++o){p.putInt16(q.value.charCodeAt(o))}}else{p.putBytes(q.value)}}m.putByte(n);if(p.length()<=127){m.putByte(p.length()&127)}else{var l=p.length();var k="";do{k+=String.fromCharCode(l&255);l=l>>>8}while(l>0);m.putByte(k.length|128);for(var o=k.length-1;o>=0;--o){m.putByte(k.charCodeAt(o))}}m.putBuffer(p);return m};g.oidToDer=function(m){var s=m.split(".");var t=h.util.createBuffer();t.putByte(40*parseInt(s[0],10)+parseInt(s[1],10));var r,k,q,p;for(var o=2;o<s.length;++o){r=true;k=[];q=parseInt(s[o],10);do{p=q&127;q=q>>>7;if(!r){p|=128}k.push(p);r=false}while(q>0);for(var l=k.length-1;l>=0;--l){t.putByte(k[l])}}return t};g.derToOid=function(l){var m;if(typeof l==="string"){l=h.util.createBuffer(l)}var k=l.getByte();m=Math.floor(k/40)+"."+(k%40);var n=0;while(l.length()>0){k=l.getByte();n=n<<7;if(k&128){n+=k&127}else{m+="."+(n+k);n=0}}return m};g.utcTimeToDate=function(u){var m=new Date();var t=parseInt(u.substr(0,2),10);t=(t>=50)?1900+t:2000+t;var v=parseInt(u.substr(2,2),10)-1;var r=parseInt(u.substr(4,2),10);var n=parseInt(u.substr(6,2),10);var p=parseInt(u.substr(8,2),10);var w=0;if(u.length>11){var s=u.charAt(10);var o=10;if(s!=="+"&&s!=="-"){w=parseInt(u.substr(10,2),10);o+=2}}m.setUTCFullYear(t,v,r);m.setUTCHours(n,p,w,0);if(o){s=u.charAt(o);if(s==="+"||s==="-"){var k=parseInt(u.substr(o+1,2),10);var l=parseInt(u.substr(o+4,2),10);var q=k*60+l;q*=60000;if(s==="+"){m.setTime(+m-q)}else{m.setTime(+m+q)}}}return m};g.generalizedTimeToDate=function(v){var o=new Date();var p=parseInt(v.substr(0,4),10);var x=parseInt(v.substr(4,2),10)-1;var u=parseInt(v.substr(6,2),10);var q=parseInt(v.substr(8,2),10);var s=parseInt(v.substr(10,2),10);var y=parseInt(v.substr(12,2),10);var n=0;var t=0;var m=false;if(v.charAt(v.length-1)==="Z"){m=true}var r=v.length-5,w=v.charAt(r);if(w==="+"||w==="-"){var k=parseInt(v.substr(r+1,2),10);var l=parseInt(v.substr(r+4,2),10);t=k*60+l;t*=60000;if(w==="+"){t*=-1}m=true}if(v.charAt(14)==="."){n=parseFloat(v.substr(14),10)*1000}if(m){o.setUTCFullYear(p,x,u);o.setUTCHours(q,s,y,n);o.setTime(+o+t)}else{o.setFullYear(p,x,u);o.setHours(q,s,y,n)}return o};g.dateToUtcTime=function(k){if(typeof k==="string"){return k}var n="";var m=[];m.push((""+k.getUTCFullYear()).substr(2));m.push(""+(k.getUTCMonth()+1));m.push(""+k.getUTCDate());m.push(""+k.getUTCHours());m.push(""+k.getUTCMinutes());m.push(""+k.getUTCSeconds());for(var l=0;l<m.length;++l){if(m[l].length<2){n+="0"}n+=m[l]}n+="Z";return n};g.dateToGeneralizedTime=function(k){if(typeof k==="string"){return k}var n="";var m=[];m.push(""+k.getUTCFullYear());m.push(""+(k.getUTCMonth()+1));m.push(""+k.getUTCDate());m.push(""+k.getUTCHours());m.push(""+k.getUTCMinutes());m.push(""+k.getUTCSeconds());for(var l=0;l<m.length;++l){if(m[l].length<2){n+="0"}n+=m[l]}n+="Z";return n};g.integerToDer=function(k){var m=h.util.createBuffer();if(k>=-128&&k<128){return m.putSignedInt(k,8)}if(k>=-32768&&k<32768){return m.putSignedInt(k,16)}if(k>=-8388608&&k<8388608){return m.putSignedInt(k,24)}if(k>=-2147483648&&k<2147483648){return m.putSignedInt(k,32)}var l=new Error("Integer too large; max is 32-bits.");l.integer=k;throw l};g.derToInteger=function(k){if(typeof k==="string"){k=h.util.createBuffer(k)}var l=k.length()*8;if(l>32){throw new Error("Integer too large; max is 32-bits.")}return k.getSignedInt(l)};g.validate=function(p,l,k,q){var o=false;if((p.tagClass===l.tagClass||typeof(l.tagClass)==="undefined")&&(p.type===l.type||typeof(l.type)==="undefined")){if(p.constructed===l.constructed||typeof(l.constructed)==="undefined"){o=true;if(l.value&&h.util.isArray(l.value)){var m=0;for(var n=0;o&&n<l.value.length;++n){o=l.value[n].optional||false;if(p.value[m]){o=g.validate(p.value[m],l.value[n],k,q);if(o){++m}else{if(l.value[n].optional){o=true}}}if(!o&&q){q.push("["+l.name+'] Tag class "'+l.tagClass+'", type "'+l.type+'" expected value length "'+l.value.length+'", got "'+p.value.length+'"')}}}if(o&&k){if(l.capture){k[l.capture]=p.value}if(l.captureAsn1){k[l.captureAsn1]=p}}}else{if(q){q.push("["+l.name+'] Expected constructed "'+l.constructed+'", got "'+p.constructed+'"')}}}else{if(q){if(p.tagClass!==l.tagClass){q.push("["+l.name+'] Expected tag class "'+l.tagClass+'", got "'+p.tagClass+'"')}if(p.type!==l.type){q.push("["+l.name+'] Expected type "'+l.type+'", got "'+p.type+'"')}}}return o};var j=/[^\\u0000-\\u00ff]/;g.prettyPrint=function(o,l,s){var q="";l=l||0;s=s||2;if(l>0){q+="\n"}var m="";for(var p=0;p<l*s;++p){m+=" "}q+=m+"Tag: ";switch(o.tagClass){case g.Class.UNIVERSAL:q+="Universal:";break;case g.Class.APPLICATION:q+="Application:";break;case g.Class.CONTEXT_SPECIFIC:q+="Context-Specific:";break;case g.Class.PRIVATE:q+="Private:";break}if(o.tagClass===g.Class.UNIVERSAL){q+=o.type;switch(o.type){case g.Type.NONE:q+=" (None)";break;case g.Type.BOOLEAN:q+=" (Boolean)";break;case g.Type.BITSTRING:q+=" (Bit string)";break;case g.Type.INTEGER:q+=" (Integer)";break;case g.Type.OCTETSTRING:q+=" (Octet string)";break;case g.Type.NULL:q+=" (Null)";break;case g.Type.OID:q+=" (Object Identifier)";break;case g.Type.ODESC:q+=" (Object Descriptor)";break;case g.Type.EXTERNAL:q+=" (External or Instance of)";break;case g.Type.REAL:q+=" (Real)";break;case g.Type.ENUMERATED:q+=" (Enumerated)";break;case g.Type.EMBEDDED:q+=" (Embedded PDV)";break;case g.Type.UTF8:q+=" (UTF8)";break;case g.Type.ROID:q+=" (Relative Object Identifier)";break;case g.Type.SEQUENCE:q+=" (Sequence)";break;case g.Type.SET:q+=" (Set)";break;case g.Type.PRINTABLESTRING:q+=" (Printable String)";break;case g.Type.IA5String:q+=" (IA5String (ASCII))";break;case g.Type.UTCTIME:q+=" (UTC time)";break;case g.Type.GENERALIZEDTIME:q+=" (Generalized time)";break;case g.Type.BMPSTRING:q+=" (BMP String)";break}}else{q+=o.type}q+="\n";q+=m+"Constructed: "+o.constructed+"\n";if(o.composed){var t=0;var k="";for(var p=0;p<o.value.length;++p){if(o.value[p]!==undefined){t+=1;k+=g.prettyPrint(o.value[p],l+1,s);if((p+1)<o.value.length){k+=","}}}q+=m+"Sub values: "+t+k}else{q+=m+"Value: ";if(o.type===g.Type.OID){var n=g.derToOid(o.value);q+=n;if(h.pki&&h.pki.oids){if(n in h.pki.oids){q+=" ("+h.pki.oids[n]+") "}}}if(o.type===g.Type.INTEGER){try{q+=g.derToInteger(o.value)}catch(r){q+="0x"+h.util.bytesToHex(o.value)}}else{if(o.type===g.Type.OCTETSTRING){if(!j.test(o.value)){q+="("+o.value+") "}q+="0x"+h.util.bytesToHex(o.value)}else{if(o.type===g.Type.UTF8){q+=h.util.decodeUtf8(o.value)}else{if(o.type===g.Type.PRINTABLESTRING||o.type===g.Type.IA5String){q+=o.value}else{if(j.test(o.value)){q+="0x"+h.util.bytesToHex(o.value)}else{if(o.value.length===0){q+="[null]"}else{q+=o.value}}}}}}}return q}}var b="asn1";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util","./oids"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(aW){var bg;var aV=244837814094590;var aJ=((aV&16777215)==15715070);function a5(bl,bk,bm){this.data=[];if(bl!=null){if("number"==typeof bl){this.fromNumber(bl,bk,bm)}else{if(bk==null&&"string"!=typeof bl){this.fromString(bl,256)}else{this.fromString(bl,bk)}}}}function s(){return new a5(null)}function g(bo,bk,bl,bn,bq,bp){while(--bp>=0){var bm=bk*this.data[bo++]+bl.data[bn]+bq;bq=Math.floor(bm/67108864);bl.data[bn++]=bm&67108863}return bq}function bi(bo,bt,bu,bn,br,bk){var bq=bt&32767,bs=bt>>15;while(--bk>=0){var bm=this.data[bo]&32767;var bp=this.data[bo++]>>15;var bl=bs*bm+bp*bq;bm=bq*bm+((bl&32767)<<15)+bu.data[bn]+(br&1073741823);br=(bm>>>30)+(bl>>>15)+bs*bp+(br>>>30);bu.data[bn++]=bm&1073741823}return br}function bh(bo,bt,bu,bn,br,bk){var bq=bt&16383,bs=bt>>14;while(--bk>=0){var bm=this.data[bo]&16383;var bp=this.data[bo++]>>14;var bl=bs*bm+bp*bq;bm=bq*bm+((bl&16383)<<14)+bu.data[bn]+br;br=(bm>>28)+(bl>>14)+bs*bp;bu.data[bn++]=bm&268435455}return br}if(typeof(navigator)==="undefined"){a5.prototype.am=bh;bg=28}else{if(aJ&&(navigator.appName=="Microsoft Internet Explorer")){a5.prototype.am=bi;bg=30}else{if(aJ&&(navigator.appName!="Netscape")){a5.prototype.am=g;bg=26}else{a5.prototype.am=bh;bg=28}}}a5.prototype.DB=bg;a5.prototype.DM=((1<<bg)-1);a5.prototype.DV=(1<<bg);var aK=52;a5.prototype.FV=Math.pow(2,aK);a5.prototype.F1=aK-bg;a5.prototype.F2=2*bg-aK;var aR="0123456789abcdefghijklmnopqrstuvwxyz";var aU=new Array();var a3,H;a3="0".charCodeAt(0);for(H=0;H<=9;++H){aU[a3++]=H}a3="a".charCodeAt(0);for(H=10;H<36;++H){aU[a3++]=H}a3="A".charCodeAt(0);for(H=10;H<36;++H){aU[a3++]=H}function bj(bk){return aR.charAt(bk)}function R(bl,bk){var bm=aU[bl.charCodeAt(bk)];return(bm==null)?-1:bm}function aI(bl){for(var bk=this.t-1;bk>=0;--bk){bl.data[bk]=this.data[bk]}bl.t=this.t;bl.s=this.s}function B(bk){this.t=1;this.s=(bk<0)?-1:0;if(bk>0){this.data[0]=bk}else{if(bk<-1){this.data[0]=bk+this.DV}else{this.t=0}}}function j(bk){var bl=s();bl.fromInt(bk);return bl}function K(bq,bl){var bn;if(bl==16){bn=4}else{if(bl==8){bn=3}else{if(bl==256){bn=8}else{if(bl==2){bn=1}else{if(bl==32){bn=5}else{if(bl==4){bn=2}else{this.fromRadix(bq,bl);return}}}}}}this.t=0;this.s=0;var bp=bq.length,bm=false,bo=0;while(--bp>=0){var bk=(bn==8)?bq[bp]&255:R(bq,bp);if(bk<0){if(bq.charAt(bp)=="-"){bm=true}continue}bm=false;if(bo==0){this.data[this.t++]=bk}else{if(bo+bn>this.DB){this.data[this.t-1]|=(bk&((1<<(this.DB-bo))-1))<<bo;this.data[this.t++]=(bk>>(this.DB-bo))}else{this.data[this.t-1]|=bk<<bo}}bo+=bn;if(bo>=this.DB){bo-=this.DB}}if(bn==8&&(bq[0]&128)!=0){this.s=-1;if(bo>0){this.data[this.t-1]|=((1<<(this.DB-bo))-1)<<bo}}this.clamp();if(bm){a5.ZERO.subTo(this,this)}}function al(){var bk=this.s&this.DM;while(this.t>0&&this.data[this.t-1]==bk){--this.t}}function D(bl){if(this.s<0){return"-"+this.negate().toString(bl)}var bm;if(bl==16){bm=4}else{if(bl==8){bm=3}else{if(bl==2){bm=1}else{if(bl==32){bm=5}else{if(bl==4){bm=2}else{return this.toRadix(bl)}}}}}var bo=(1<<bm)-1,br,bk=false,bp="",bn=this.t;var bq=this.DB-(bn*this.DB)%bm;if(bn-->0){if(bq<this.DB&&(br=this.data[bn]>>bq)>0){bk=true;bp=bj(br)}while(bn>=0){if(bq<bm){br=(this.data[bn]&((1<<bq)-1))<<(bm-bq);br|=this.data[--bn]>>(bq+=this.DB-bm)}else{br=(this.data[bn]>>(bq-=bm))&bo;if(bq<=0){bq+=this.DB;--bn}}if(br>0){bk=true}if(bk){bp+=bj(br)}}}return bk?bp:"0"}function ap(){var bk=s();a5.ZERO.subTo(this,bk);return bk}function aZ(){return(this.s<0)?this.negate():this}function ab(bk){var bm=this.s-bk.s;if(bm!=0){return bm}var bl=this.t;bm=bl-bk.t;if(bm!=0){return(this.s<0)?-bm:bm}while(--bl>=0){if((bm=this.data[bl]-bk.data[bl])!=0){return bm}}return 0}function x(bk){var bm=1,bl;if((bl=bk>>>16)!=0){bk=bl;bm+=16}if((bl=bk>>8)!=0){bk=bl;bm+=8}if((bl=bk>>4)!=0){bk=bl;bm+=4}if((bl=bk>>2)!=0){bk=bl;bm+=2}if((bl=bk>>1)!=0){bk=bl;bm+=1}return bm}function G(){if(this.t<=0){return 0}return this.DB*(this.t-1)+x(this.data[this.t-1]^(this.s&this.DM))}function a4(bm,bl){var bk;for(bk=this.t-1;bk>=0;--bk){bl.data[bk+bm]=this.data[bk]}for(bk=bm-1;bk>=0;--bk){bl.data[bk]=0}bl.t=this.t+bm;bl.s=this.s}function aH(bm,bl){for(var bk=bm;bk<this.t;++bk){bl.data[bk-bm]=this.data[bk]}bl.t=Math.max(this.t-bm,0);bl.s=this.s}function F(bt,bo){var bl=bt%this.DB;var bk=this.DB-bl;var bq=(1<<bk)-1;var bp=Math.floor(bt/this.DB),br=(this.s<<bl)&this.DM,bn;for(bn=this.t-1;bn>=0;--bn){bo.data[bn+bp+1]=(this.data[bn]>>bk)|br;br=(this.data[bn]&bq)<<bl}for(bn=bp-1;bn>=0;--bn){bo.data[bn]=0}bo.data[bp]=br;bo.t=this.t+bp+1;bo.s=this.s;bo.clamp()}function y(br,bo){bo.s=this.s;var bp=Math.floor(br/this.DB);if(bp>=this.t){bo.t=0;return}var bl=br%this.DB;var bk=this.DB-bl;var bq=(1<<bl)-1;bo.data[0]=this.data[bp]>>bl;for(var bn=bp+1;bn<this.t;++bn){bo.data[bn-bp-1]|=(this.data[bn]&bq)<<bk;bo.data[bn-bp]=this.data[bn]>>bl}if(bl>0){bo.data[this.t-bp-1]|=(this.s&bq)<<bk}bo.t=this.t-bp;bo.clamp()}function aL(bl,bn){var bm=0,bo=0,bk=Math.min(bl.t,this.t);while(bm<bk){bo+=this.data[bm]-bl.data[bm];bn.data[bm++]=bo&this.DM;bo>>=this.DB}if(bl.t<this.t){bo-=bl.s;while(bm<this.t){bo+=this.data[bm];bn.data[bm++]=bo&this.DM;bo>>=this.DB}bo+=this.s}else{bo+=this.s;while(bm<bl.t){bo-=bl.data[bm];bn.data[bm++]=bo&this.DM;bo>>=this.DB}bo-=bl.s}bn.s=(bo<0)?-1:0;if(bo<-1){bn.data[bm++]=this.DV+bo}else{if(bo>0){bn.data[bm++]=bo}}bn.t=bm;bn.clamp()}function W(bl,bn){var bk=this.abs(),bo=bl.abs();var bm=bk.t;bn.t=bm+bo.t;while(--bm>=0){bn.data[bm]=0}for(bm=0;bm<bo.t;++bm){bn.data[bm+bk.t]=bk.am(0,bo.data[bm],bn,bm,0,bk.t)}bn.s=0;bn.clamp();if(this.s!=bl.s){a5.ZERO.subTo(bn,bn)}}function an(bm){var bk=this.abs();var bl=bm.t=2*bk.t;while(--bl>=0){bm.data[bl]=0}for(bl=0;bl<bk.t-1;++bl){var bn=bk.am(bl,bk.data[bl],bm,2*bl,0,1);if((bm.data[bl+bk.t]+=bk.am(bl+1,2*bk.data[bl],bm,2*bl+1,bn,bk.t-bl-1))>=bk.DV){bm.data[bl+bk.t]-=bk.DV;bm.data[bl+bk.t+1]=1}}if(bm.t>0){bm.data[bm.t-1]+=bk.am(bl,bk.data[bl],bm,2*bl,0,1)}bm.s=0;bm.clamp()}function X(bt,bq,bp){var bz=bt.abs();if(bz.t<=0){return}var br=this.abs();if(br.t<bz.t){if(bq!=null){bq.fromInt(0)}if(bp!=null){this.copyTo(bp)}return}if(bp==null){bp=s()}var bn=s(),bk=this.s,bs=bt.s;var by=this.DB-x(bz.data[bz.t-1]);if(by>0){bz.lShiftTo(by,bn);br.lShiftTo(by,bp)}else{bz.copyTo(bn);br.copyTo(bp)}var bv=bn.t;var bl=bn.data[bv-1];if(bl==0){return}var bu=bl*(1<<this.F1)+((bv>1)?bn.data[bv-2]>>this.F2:0);var bC=this.FV/bu,bB=(1<<this.F1)/bu,bA=1<<this.F2;var bx=bp.t,bw=bx-bv,bo=(bq==null)?s():bq;bn.dlShiftTo(bw,bo);if(bp.compareTo(bo)>=0){bp.data[bp.t++]=1;bp.subTo(bo,bp)}a5.ONE.dlShiftTo(bv,bo);bo.subTo(bn,bn);while(bn.t<bv){bn.data[bn.t++]=0}while(--bw>=0){var bm=(bp.data[--bx]==bl)?this.DM:Math.floor(bp.data[bx]*bC+(bp.data[bx-1]+bA)*bB);if((bp.data[bx]+=bn.am(0,bm,bp,bw,0,bv))<bm){bn.dlShiftTo(bw,bo);bp.subTo(bo,bp);while(bp.data[bx]<--bm){bp.subTo(bo,bp)}}}if(bq!=null){bp.drShiftTo(bv,bq);if(bk!=bs){a5.ZERO.subTo(bq,bq)}}bp.t=bv;bp.clamp();if(by>0){bp.rShiftTo(by,bp)}if(bk<0){a5.ZERO.subTo(bp,bp)}}function ak(bk){var bl=s();this.abs().divRemTo(bk,null,bl);if(this.s<0&&bl.compareTo(a5.ZERO)>0){bk.subTo(bl,bl)}return bl}function af(bk){this.m=bk}function aD(bk){if(bk.s<0||bk.compareTo(this.m)>=0){return bk.mod(this.m)}else{return bk}}function aY(bk){return bk}function ad(bk){bk.divRemTo(this.m,null,bk)}function ac(bk,bm,bl){bk.multiplyTo(bm,bl);this.reduce(bl)}function ba(bk,bl){bk.squareTo(bl);this.reduce(bl)}af.prototype.convert=aD;af.prototype.revert=aY;af.prototype.reduce=ad;af.prototype.mulTo=ac;af.prototype.sqrTo=ba;function T(){if(this.t<1){return 0}var bk=this.data[0];if((bk&1)==0){return 0}var bl=bk&3;bl=(bl*(2-(bk&15)*bl))&15;bl=(bl*(2-(bk&255)*bl))&255;bl=(bl*(2-(((bk&65535)*bl)&65535)))&65535;bl=(bl*(2-bk*bl%this.DV))%this.DV;return(bl>0)?this.DV-bl:-bl}function n(bk){this.m=bk;this.mp=bk.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(bk.DB-15))-1;this.mt2=2*bk.t}function aX(bk){var bl=s();bk.abs().dlShiftTo(this.m.t,bl);bl.divRemTo(this.m,null,bl);if(bk.s<0&&bl.compareTo(a5.ZERO)>0){this.m.subTo(bl,bl)}return bl}function a8(bk){var bl=s();bk.copyTo(bl);this.reduce(bl);return bl}function am(bk){while(bk.t<=this.mt2){bk.data[bk.t++]=0}for(var bm=0;bm<this.m.t;++bm){var bl=bk.data[bm]&32767;var bn=(bl*this.mpl+(((bl*this.mph+(bk.data[bm]>>15)*this.mpl)&this.um)<<15))&bk.DM;bl=bm+this.m.t;bk.data[bl]+=this.m.am(0,bn,bk,bm,0,this.m.t);while(bk.data[bl]>=bk.DV){bk.data[bl]-=bk.DV;bk.data[++bl]++}}bk.clamp();bk.drShiftTo(this.m.t,bk);if(bk.compareTo(this.m)>=0){bk.subTo(this.m,bk)}}function a0(bk,bl){bk.squareTo(bl);this.reduce(bl)}function Q(bk,bm,bl){bk.multiplyTo(bm,bl);this.reduce(bl)}n.prototype.convert=aX;n.prototype.revert=a8;n.prototype.reduce=am;n.prototype.mulTo=Q;n.prototype.sqrTo=a0;function t(){return((this.t>0)?(this.data[0]&1):this.s)==0}function L(bp,bq){if(bp>4294967295||bp<1){return a5.ONE}var bo=s(),bk=s(),bn=bq.convert(this),bm=x(bp)-1;bn.copyTo(bo);while(--bm>=0){bq.sqrTo(bo,bk);if((bp&(1<<bm))>0){bq.mulTo(bk,bn,bo)}else{var bl=bo;bo=bk;bk=bl}}return bq.revert(bo)}function a2(bl,bk){var bm;if(bl<256||bk.isEven()){bm=new af(bk)}else{bm=new n(bk)}return this.exp(bl,bm)}a5.prototype.copyTo=aI;a5.prototype.fromInt=B;a5.prototype.fromString=K;a5.prototype.clamp=al;a5.prototype.dlShiftTo=a4;a5.prototype.drShiftTo=aH;a5.prototype.lShiftTo=F;a5.prototype.rShiftTo=y;a5.prototype.subTo=aL;a5.prototype.multiplyTo=W;a5.prototype.squareTo=an;a5.prototype.divRemTo=X;a5.prototype.invDigit=T;a5.prototype.isEven=t;a5.prototype.exp=L;a5.prototype.toString=D;a5.prototype.negate=ap;a5.prototype.abs=aZ;a5.prototype.compareTo=ab;a5.prototype.bitLength=G;a5.prototype.mod=ak;a5.prototype.modPowInt=a2;a5.ZERO=j(0);a5.ONE=j(1);function q(){var bk=s();this.copyTo(bk);return bk}function Z(){if(this.s<0){if(this.t==1){return this.data[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this.data[0]}else{if(this.t==0){return 0}}}return((this.data[1]&((1<<(32-this.DB))-1))<<this.DB)|this.data[0]}function aS(){return(this.t==0)?this.s:(this.data[0]<<24)>>24}function ao(){return(this.t==0)?this.s:(this.data[0]<<16)>>16}function aF(bk){return Math.floor(Math.LN2*this.DB/Math.log(bk))}function a6(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this.data[0]<=0)){return 0}else{return 1}}}function O(bk){if(bk==null){bk=10}if(this.signum()==0||bk<2||bk>36){return"0"}var bm=this.chunkSize(bk);var bl=Math.pow(bk,bm);var bp=j(bl),bq=s(),bo=s(),bn="";this.divRemTo(bp,bq,bo);while(bq.signum()>0){bn=(bl+bo.intValue()).toString(bk).substr(1)+bn;bq.divRemTo(bp,bq,bo)}return bo.intValue().toString(bk)+bn}function aw(bs,bp){this.fromInt(0);if(bp==null){bp=10}var bn=this.chunkSize(bp);var bo=Math.pow(bp,bn),bm=false,bk=0,br=0;for(var bl=0;bl<bs.length;++bl){var bq=R(bs,bl);if(bq<0){if(bs.charAt(bl)=="-"&&this.signum()==0){bm=true}continue}br=bp*br+bq;if(++bk>=bn){this.dMultiply(bo);this.dAddOffset(br,0);bk=0;br=0}}if(bk>0){this.dMultiply(Math.pow(bp,bk));this.dAddOffset(br,0)}if(bm){a5.ZERO.subTo(this,this)}}function aP(bm,bl,bo){if("number"==typeof bl){if(bm<2){this.fromInt(1)}else{this.fromNumber(bm,bo);if(!this.testBit(bm-1)){this.bitwiseTo(a5.ONE.shiftLeft(bm-1),ah,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(bl)){this.dAddOffset(2,0);if(this.bitLength()>bm){this.subTo(a5.ONE.shiftLeft(bm-1),this)}}}}else{var bk=new Array(),bn=bm&7;bk.length=(bm>>3)+1;bl.nextBytes(bk);if(bn>0){bk[0]&=((1<<bn)-1)}else{bk[0]=0}this.fromString(bk,256)}}function bd(){var bl=this.t,bm=new Array();bm[0]=this.s;var bn=this.DB-(bl*this.DB)%8,bo,bk=0;if(bl-->0){if(bn<this.DB&&(bo=this.data[bl]>>bn)!=(this.s&this.DM)>>bn){bm[bk++]=bo|(this.s<<(this.DB-bn))}while(bl>=0){if(bn<8){bo=(this.data[bl]&((1<<bn)-1))<<(8-bn);bo|=this.data[--bl]>>(bn+=this.DB-8)}else{bo=(this.data[bl]>>(bn-=8))&255;if(bn<=0){bn+=this.DB;--bl}}if((bo&128)!=0){bo|=-256}if(bk==0&&(this.s&128)!=(bo&128)){++bk}if(bk>0||bo!=this.s){bm[bk++]=bo}}}return bm}function ar(bk){return(this.compareTo(bk)==0)}function aa(bk){return(this.compareTo(bk)<0)?this:bk}function aB(bk){return(this.compareTo(bk)>0)?this:bk}function aQ(bl,bp,bn){var bm,bo,bk=Math.min(bl.t,this.t);for(bm=0;bm<bk;++bm){bn.data[bm]=bp(this.data[bm],bl.data[bm])}if(bl.t<this.t){bo=bl.s&this.DM;for(bm=bk;bm<this.t;++bm){bn.data[bm]=bp(this.data[bm],bo)}bn.t=this.t}else{bo=this.s&this.DM;for(bm=bk;bm<bl.t;++bm){bn.data[bm]=bp(bo,bl.data[bm])}bn.t=bl.t}bn.s=bp(this.s,bl.s);bn.clamp()}function P(bk,bl){return bk&bl}function bf(bk){var bl=s();this.bitwiseTo(bk,P,bl);return bl}function ah(bk,bl){return bk|bl}function aG(bk){var bl=s();this.bitwiseTo(bk,ah,bl);return bl}function U(bk,bl){return bk^bl}function l(bk){var bl=s();this.bitwiseTo(bk,U,bl);return bl}function I(bk,bl){return bk&~bl}function z(bk){var bl=s();this.bitwiseTo(bk,I,bl);return bl}function V(){var bl=s();for(var bk=0;bk<this.t;++bk){bl.data[bk]=this.DM&~this.data[bk]}bl.t=this.t;bl.s=~this.s;return bl}function J(bl){var bk=s();if(bl<0){this.rShiftTo(-bl,bk)}else{this.lShiftTo(bl,bk)}return bk}function be(bl){var bk=s();if(bl<0){this.lShiftTo(-bl,bk)}else{this.rShiftTo(bl,bk)}return bk}function v(bk){if(bk==0){return -1}var bl=0;if((bk&65535)==0){bk>>=16;bl+=16}if((bk&255)==0){bk>>=8;bl+=8}if((bk&15)==0){bk>>=4;bl+=4}if((bk&3)==0){bk>>=2;bl+=2}if((bk&1)==0){++bl}return bl}function C(){for(var bk=0;bk<this.t;++bk){if(this.data[bk]!=0){return bk*this.DB+v(this.data[bk])}}if(this.s<0){return this.t*this.DB}return -1}function a1(bk){var bl=0;while(bk!=0){bk&=bk-1;++bl}return bl}function aO(){var bm=0,bk=this.s&this.DM;for(var bl=0;bl<this.t;++bl){bm+=a1(this.data[bl]^bk)}return bm}function aM(bl){var bk=Math.floor(bl/this.DB);if(bk>=this.t){return(this.s!=0)}return((this.data[bk]&(1<<(bl%this.DB)))!=0)}function Y(bm,bl){var bk=a5.ONE.shiftLeft(bm);this.bitwiseTo(bk,bl,bk);return bk}function S(bk){return this.changeBit(bk,ah)}function A(bk){return this.changeBit(bk,I)}function i(bk){return this.changeBit(bk,U)}function ax(bl,bn){var bm=0,bo=0,bk=Math.min(bl.t,this.t);while(bm<bk){bo+=this.data[bm]+bl.data[bm];bn.data[bm++]=bo&this.DM;bo>>=this.DB}if(bl.t<this.t){bo+=bl.s;while(bm<this.t){bo+=this.data[bm];bn.data[bm++]=bo&this.DM;bo>>=this.DB}bo+=this.s}else{bo+=this.s;while(bm<bl.t){bo+=bl.data[bm];bn.data[bm++]=bo&this.DM;bo>>=this.DB}bo+=bl.s}bn.s=(bo<0)?-1:0;if(bo>0){bn.data[bm++]=bo}else{if(bo<-1){bn.data[bm++]=this.DV+bo}}bn.t=bm;bn.clamp()}function az(bk){var bl=s();this.addTo(bk,bl);return bl}function a7(bk){var bl=s();this.subTo(bk,bl);return bl}function aq(bk){var bl=s();this.multiplyTo(bk,bl);return bl}function k(bk){var bl=s();this.divRemTo(bk,bl,null);return bl}function p(bk){var bl=s();this.divRemTo(bk,null,bl);return bl}function aN(bk){var bm=s(),bl=s();this.divRemTo(bk,bm,bl);return new Array(bm,bl)}function u(bk){this.data[this.t]=this.am(0,bk-1,this,0,0,this.t);++this.t;this.clamp()}function aj(bl,bk){if(bl==0){return}while(this.t<=bk){this.data[this.t++]=0}this.data[bk]+=bl;while(this.data[bk]>=this.DV){this.data[bk]-=this.DV;if(++bk>=this.t){this.data[this.t++]=0}++this.data[bk]}}function ay(){}function aT(bk){return bk}function w(bk,bm,bl){bk.multiplyTo(bm,bl)}function aE(bk,bl){bk.squareTo(bl)}ay.prototype.convert=aT;ay.prototype.revert=aT;ay.prototype.mulTo=w;ay.prototype.sqrTo=aE;function M(bk){return this.exp(bk,new ay())}function r(bk,bo,bn){var bm=Math.min(this.t+bk.t,bo);bn.s=0;bn.t=bm;while(bm>0){bn.data[--bm]=0}var bl;for(bl=bn.t-this.t;bm<bl;++bm){bn.data[bm+this.t]=this.am(0,bk.data[bm],bn,bm,0,this.t)}for(bl=Math.min(bk.t,bo);bm<bl;++bm){this.am(0,bk.data[bm],bn,bm,0,bo-bm)}bn.clamp()}function m(bk,bn,bm){--bn;var bl=bm.t=this.t+bk.t-bn;bm.s=0;while(--bl>=0){bm.data[bl]=0}for(bl=Math.max(bn-this.t,0);bl<bk.t;++bl){bm.data[this.t+bl-bn]=this.am(bn-bl,bk.data[bl],bm,0,0,this.t+bl-bn)}bm.clamp();bm.drShiftTo(1,bm)}function N(bk){this.r2=s();this.q3=s();a5.ONE.dlShiftTo(2*bk.t,this.r2);this.mu=this.r2.divide(bk);this.m=bk}function ae(bk){if(bk.s<0||bk.t>2*this.m.t){return bk.mod(this.m)}else{if(bk.compareTo(this.m)<0){return bk}else{var bl=s();bk.copyTo(bl);this.reduce(bl);return bl}}}function ai(bk){return bk}function bb(bk){bk.drShiftTo(this.m.t-1,this.r2);if(bk.t>this.m.t+1){bk.t=this.m.t+1;bk.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(bk.compareTo(this.r2)<0){bk.dAddOffset(1,this.m.t+1)}bk.subTo(this.r2,bk);while(bk.compareTo(this.m)>=0){bk.subTo(this.m,bk)}}function at(bk,bl){bk.squareTo(bl);this.reduce(bl)}function bc(bk,bm,bl){bk.multiplyTo(bm,bl);this.reduce(bl)}N.prototype.convert=ae;N.prototype.revert=ai;N.prototype.reduce=bb;N.prototype.mulTo=bc;N.prototype.sqrTo=at;function aC(bt,bo){var br=bt.bitLength(),bp,bl=j(1),bw;if(br<=0){return bl}else{if(br<18){bp=1}else{if(br<48){bp=3}else{if(br<144){bp=4}else{if(br<768){bp=5}else{bp=6}}}}}if(br<8){bw=new af(bo)}else{if(bo.isEven()){bw=new N(bo)}else{bw=new n(bo)}}var bs=new Array(),bn=3,bu=bp-1,bk=(1<<bp)-1;bs[1]=bw.convert(this);if(bp>1){var bz=s();bw.sqrTo(bs[1],bz);while(bn<=bk){bs[bn]=s();bw.mulTo(bz,bs[bn-2],bs[bn]);bn+=2}}var bq=bt.t-1,bx,bv=true,bm=s(),by;br=x(bt.data[bq])-1;while(bq>=0){if(br>=bu){bx=(bt.data[bq]>>(br-bu))&bk}else{bx=(bt.data[bq]&((1<<(br+1))-1))<<(bu-br);if(bq>0){bx|=bt.data[bq-1]>>(this.DB+br-bu)}}bn=bp;while((bx&1)==0){bx>>=1;--bn}if((br-=bn)<0){br+=this.DB;--bq}if(bv){bs[bx].copyTo(bl);bv=false}else{while(bn>1){bw.sqrTo(bl,bm);bw.sqrTo(bm,bl);bn-=2}if(bn>0){bw.sqrTo(bl,bm)}else{by=bl;bl=bm;bm=by}bw.mulTo(bm,bs[bx],bl)}while(bq>=0&&(bt.data[bq]&(1<<br))==0){bw.sqrTo(bl,bm);by=bl;bl=bm;bm=by;if(--br<0){br=this.DB-1;--bq}}}return bw.revert(bl)}function a9(bl){var bk=(this.s<0)?this.negate():this.clone();var bp=(bl.s<0)?bl.negate():bl.clone();if(bk.compareTo(bp)<0){var bn=bk;bk=bp;bp=bn}var bm=bk.getLowestSetBit(),bo=bp.getLowestSetBit();if(bo<0){return bk}if(bm<bo){bo=bm}if(bo>0){bk.rShiftTo(bo,bk);bp.rShiftTo(bo,bp)}while(bk.signum()>0){if((bm=bk.getLowestSetBit())>0){bk.rShiftTo(bm,bk)}if((bm=bp.getLowestSetBit())>0){bp.rShiftTo(bm,bp)}if(bk.compareTo(bp)>=0){bk.subTo(bp,bk);bk.rShiftTo(1,bk)}else{bp.subTo(bk,bp);bp.rShiftTo(1,bp)}}if(bo>0){bp.lShiftTo(bo,bp)}return bp}function E(bn){if(bn<=0){return 0}var bm=this.DV%bn,bl=(this.s<0)?bn-1:0;if(this.t>0){if(bm==0){bl=this.data[0]%bn}else{for(var bk=this.t-1;bk>=0;--bk){bl=(bm*bl+this.data[bk])%bn}}}return bl}function h(bl){var bp=bl.isEven();if((this.isEven()&&bp)||bl.signum()==0){return a5.ZERO}var bo=bl.clone(),bn=this.clone();var bm=j(1),bk=j(0),br=j(0),bq=j(1);while(bo.signum()!=0){while(bo.isEven()){bo.rShiftTo(1,bo);if(bp){if(!bm.isEven()||!bk.isEven()){bm.addTo(this,bm);bk.subTo(bl,bk)}bm.rShiftTo(1,bm)}else{if(!bk.isEven()){bk.subTo(bl,bk)}}bk.rShiftTo(1,bk)}while(bn.isEven()){bn.rShiftTo(1,bn);if(bp){if(!br.isEven()||!bq.isEven()){br.addTo(this,br);bq.subTo(bl,bq)}br.rShiftTo(1,br)}else{if(!bq.isEven()){bq.subTo(bl,bq)}}bq.rShiftTo(1,bq)}if(bo.compareTo(bn)>=0){bo.subTo(bn,bo);if(bp){bm.subTo(br,bm)}bk.subTo(bq,bk)}else{bn.subTo(bo,bn);if(bp){br.subTo(bm,br)}bq.subTo(bk,bq)}}if(bn.compareTo(a5.ONE)!=0){return a5.ZERO}if(bq.compareTo(bl)>=0){return bq.subtract(bl)}if(bq.signum()<0){bq.addTo(bl,bq)}else{return bq}if(bq.signum()<0){return bq.add(bl)}else{return bq}}var au=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var av=(1<<26)/au[au.length-1];function ag(bo){var bn,bl=this.abs();if(bl.t==1&&bl.data[0]<=au[au.length-1]){for(bn=0;bn<au.length;++bn){if(bl.data[0]==au[bn]){return true}}return false}if(bl.isEven()){return false}bn=1;while(bn<au.length){var bk=au[bn],bm=bn+1;while(bm<au.length&&bk<av){bk*=au[bm++]}bk=bl.modInt(bk);while(bn<bm){if(bk%au[bn++]==0){return false}}}return bl.millerRabin(bo)}function o(bs){var bo=this.subtract(a5.ONE);var bl=bo.getLowestSetBit();if(bl<=0){return false}var bk=bo.shiftRight(bl);var br=aA();var bq;for(var bn=0;bn<bs;++bn){do{bq=new a5(this.bitLength(),br)}while(bq.compareTo(a5.ONE)<=0||bq.compareTo(bo)>=0);var bp=bq.modPow(bk,this);if(bp.compareTo(a5.ONE)!=0&&bp.compareTo(bo)!=0){var bm=1;while(bm++<bl&&bp.compareTo(bo)!=0){bp=bp.modPowInt(2,this);if(bp.compareTo(a5.ONE)==0){return false}}if(bp.compareTo(bo)!=0){return false}}}return true}function aA(){return{nextBytes:function(bk){for(var bl=0;bl<bk.length;++bl){bk[bl]=Math.floor(Math.random()*256)}}}}a5.prototype.chunkSize=aF;a5.prototype.toRadix=O;a5.prototype.fromRadix=aw;a5.prototype.fromNumber=aP;a5.prototype.bitwiseTo=aQ;a5.prototype.changeBit=Y;a5.prototype.addTo=ax;a5.prototype.dMultiply=u;a5.prototype.dAddOffset=aj;a5.prototype.multiplyLowerTo=r;a5.prototype.multiplyUpperTo=m;a5.prototype.modInt=E;a5.prototype.millerRabin=o;a5.prototype.clone=q;a5.prototype.intValue=Z;a5.prototype.byteValue=aS;a5.prototype.shortValue=ao;a5.prototype.signum=a6;a5.prototype.toByteArray=bd;a5.prototype.equals=ar;a5.prototype.min=aa;a5.prototype.max=aB;a5.prototype.and=bf;a5.prototype.or=aG;a5.prototype.xor=l;a5.prototype.andNot=z;a5.prototype.not=V;a5.prototype.shiftLeft=J;a5.prototype.shiftRight=be;a5.prototype.getLowestSetBit=C;a5.prototype.bitCount=aO;a5.prototype.testBit=aM;a5.prototype.setBit=S;a5.prototype.clearBit=A;a5.prototype.flipBit=i;a5.prototype.add=az;a5.prototype.subtract=a7;a5.prototype.multiply=aq;a5.prototype.divide=k;a5.prototype.remainder=p;a5.prototype.divideAndRemainder=aN;a5.prototype.modPow=aC;a5.prototype.modInverse=h;a5.prototype.pow=M;a5.prototype.gcd=a9;a5.prototype.isProbablePrime=ag;aW.jsbn=aW.jsbn||{};aW.jsbn.BigInteger=a5}var b="jsbn";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){var i=(typeof process!=="undefined"&&process.versions&&process.versions.node);var j=null;if(!g.disableNativeCode&&i&&!process.versions["node-webkit"]){j=require("crypto")}var h=g.prng=g.prng||{};h.create=function(p){var s={plugin:p,key:null,seed:null,time:null,reseeds:0,generated:0};var q=p.md;var r=new Array(32);for(var o=0;o<32;++o){r[o]=q.create()}s.pools=r;s.pool=0;s.generate=function(y,A){if(!A){return s.generateSync(y)}var v=s.plugin.cipher;var u=s.plugin.increment;var z=s.plugin.formatKey;var x=s.plugin.formatSeed;var t=g.util.createBuffer();s.key=null;w();function w(C){if(C){return A(C)}if(t.length()>=y){return A(null,t.getBytes(y))}if(s.generated>1048575){s.key=null}if(s.key===null){return g.util.nextTick(function(){k(w)})}var B=v(s.key,s.seed);s.generated+=B.length;t.putBytes(B);s.key=z(v(s.key,u(s.seed)));s.seed=x(v(s.key,s.seed));g.util.setImmediate(w)}};s.generateSync=function(y){var v=s.plugin.cipher;var u=s.plugin.increment;var z=s.plugin.formatKey;var x=s.plugin.formatSeed;s.key=null;var t=g.util.createBuffer();while(t.length()<y){if(s.generated>1048575){s.key=null}if(s.key===null){l()}var w=v(s.key,s.seed);s.generated+=w.length;t.putBytes(w);s.key=z(v(s.key,u(s.seed)));s.seed=x(v(s.key,s.seed))}return t.getBytes(y)};function k(u){if(s.pools[0].messageLength>=32){m();return u()}var t=(32-s.pools[0].messageLength)<<5;s.seedFile(t,function(w,v){if(w){return u(w)}s.collect(v);m();u()})}function l(){if(s.pools[0].messageLength>=32){return m()}var t=(32-s.pools[0].messageLength)<<5;s.collect(s.seedFileSync(t));m()}function m(){var x=s.plugin.md.create();x.update(s.pools[0].digest().getBytes());s.pools[0].start();var v=1;for(var w=1;w<32;++w){v=(v===31)?2147483648:(v<<2);if(v%s.reseeds===0){x.update(s.pools[w].digest().getBytes());s.pools[w].start()}}var u=x.digest().getBytes();x.start();x.update(u);var t=x.digest().getBytes();s.key=s.plugin.formatKey(u);s.seed=s.plugin.formatSeed(t);s.reseeds=(s.reseeds===4294967295)?0:s.reseeds+1;s.generated=0}function n(D){var E=null;if(typeof window!=="undefined"){var x=window.crypto||window.msCrypto;if(x&&x.getRandomValues){E=function(F){return x.getRandomValues(F)}}}var C=g.util.createBuffer();if(E){while(C.length()<D){var y=Math.max(1,Math.min(D-C.length(),65536)/4);var B=new Uint32Array(Math.floor(y));try{E(B);for(var u=0;u<B.length;++u){C.putInt32(B[u])}}catch(A){if(!(typeof QuotaExceededError!=="undefined"&&A instanceof QuotaExceededError)){throw A}}}}if(C.length()<D){var t,z,w;var v=Math.floor(Math.random()*65536);while(C.length()<D){z=16807*(v&65535);t=16807*(v>>16);z+=(t&32767)<<16;z+=t>>15;z=(z&2147483647)+(z>>31);v=z&4294967295;for(var u=0;u<3;++u){w=v>>>(u<<3);w^=Math.floor(Math.random()*256);C.putByte(String.fromCharCode(w&255))}}}return C.getBytes(D)}if(j){s.seedFile=function(t,u){j.randomBytes(t,function(w,v){if(w){return u(w)}u(null,v.toString())})};s.seedFileSync=function(t){return j.randomBytes(t).toString()}}else{s.seedFile=function(t,v){try{v(null,n(t))}catch(u){v(u)}};s.seedFileSync=n}s.collect=function(t){var v=t.length;for(var u=0;u<v;++u){s.pools[s.pool].update(t.substr(u,1));s.pool=(s.pool===31)?0:s.pool+1}};s.collectInt=function(v,w){var u="";for(var t=0;t<w;t+=8){u+=String.fromCharCode((v>>t)&255)}s.collect(u)};s.registerWorker=function(u){if(u===self){s.seedFile=function(v,x){function w(z){var y=z.data;if(y.forge&&y.forge.prng){self.removeEventListener("message",w);x(y.forge.prng.err,y.forge.prng.bytes)}}self.addEventListener("message",w);self.postMessage({forge:{prng:{needed:v}}})}}else{var t=function(w){var v=w.data;if(v.forge&&v.forge.prng){s.seedFile(v.forge.prng.needed,function(y,x){u.postMessage({forge:{prng:{err:y,bytes:x}}})})}};u.addEventListener("message",t)}};return s}}var b="prng";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./md","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){if(g.random&&g.random.getBytes){return}(function(s){var p={};var l=new Array(4);var k=g.util.createBuffer();p.formatKey=function(u){var t=g.util.createBuffer(u);u=new Array(4);u[0]=t.getInt32();u[1]=t.getInt32();u[2]=t.getInt32();u[3]=t.getInt32();return g.aes._expandKey(u,false)};p.formatSeed=function(t){var u=g.util.createBuffer(t);t=new Array(4);t[0]=u.getInt32();t[1]=u.getInt32();t[2]=u.getInt32();t[3]=u.getInt32();return t};p.cipher=function(u,t){g.aes._updateBlock(u,t,l,false);k.putInt32(l[0]);k.putInt32(l[1]);k.putInt32(l[2]);k.putInt32(l[3]);return k.getBytes()};p.increment=function(t){++t[3];return t};p.md=g.md.sha256;function j(){var t=g.prng.create(p);t.getBytes=function(u,v){return t.generate(u,v)};t.getBytesSync=function(u){return t.generate(u)};return t}var i=j();var n=(typeof process!=="undefined"&&process.versions&&process.versions.node);var r=null;if(typeof window!=="undefined"){var m=window.crypto||window.msCrypto;if(m&&m.getRandomValues){r=function(t){return m.getRandomValues(t)}}}if(g.disableNativeCode||(!n&&!r)){if(typeof window==="undefined"||window.document===undefined){}i.collectInt(+new Date(),32);if(typeof(navigator)!=="undefined"){var h="";for(var q in navigator){try{if(typeof(navigator[q])=="string"){h+=navigator[q]}}catch(o){}}i.collect(h);h=null}if(s){s().mousemove(function(t){i.collectInt(t.clientX,16);i.collectInt(t.clientY,16)});s().keypress(function(t){i.collectInt(t.charCode,8)})}}if(!g.random){g.random=i}else{for(var q in i){g.random[q]=i[q]}}g.random.createInstance=j})(typeof(jQuery)!=="undefined"?jQuery:null)}var b="random";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./aes","./md","./prng","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(h){h.pki=h.pki||{};var g=h.pki.oids=h.oids=h.oids||{};g["1.2.840.113549.1.1.1"]="rsaEncryption";g.rsaEncryption="1.2.840.113549.1.1.1";g["1.2.840.113549.1.1.4"]="md5WithRSAEncryption";g.md5WithRSAEncryption="1.2.840.113549.1.1.4";g["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption";g.sha1WithRSAEncryption="1.2.840.113549.1.1.5";g["1.2.840.113549.1.1.7"]="RSAES-OAEP";g["RSAES-OAEP"]="1.2.840.113549.1.1.7";g["1.2.840.113549.1.1.8"]="mgf1";g.mgf1="1.2.840.113549.1.1.8";g["1.2.840.113549.1.1.9"]="pSpecified";g.pSpecified="1.2.840.113549.1.1.9";g["1.2.840.113549.1.1.10"]="RSASSA-PSS";g["RSASSA-PSS"]="1.2.840.113549.1.1.10";g["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption";g.sha256WithRSAEncryption="1.2.840.113549.1.1.11";g["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption";g.sha384WithRSAEncryption="1.2.840.113549.1.1.12";g["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption";g.sha512WithRSAEncryption="1.2.840.113549.1.1.13";g["1.3.14.3.2.7"]="desCBC";g.desCBC="1.3.14.3.2.7";g["1.3.14.3.2.26"]="sha1";g.sha1="1.3.14.3.2.26";g["2.16.840.1.101.3.4.2.1"]="sha256";g.sha256="2.16.840.1.101.3.4.2.1";g["2.16.840.1.101.3.4.2.2"]="sha384";g.sha384="2.16.840.1.101.3.4.2.2";g["2.16.840.1.101.3.4.2.3"]="sha512";g.sha512="2.16.840.1.101.3.4.2.3";g["1.2.840.113549.2.5"]="md5";g.md5="1.2.840.113549.2.5";g["1.2.840.113549.1.7.1"]="data";g.data="1.2.840.113549.1.7.1";g["1.2.840.113549.1.7.2"]="signedData";g.signedData="1.2.840.113549.1.7.2";g["1.2.840.113549.1.7.3"]="envelopedData";g.envelopedData="1.2.840.113549.1.7.3";g["1.2.840.113549.1.7.4"]="signedAndEnvelopedData";g.signedAndEnvelopedData="1.2.840.113549.1.7.4";g["1.2.840.113549.1.7.5"]="digestedData";g.digestedData="1.2.840.113549.1.7.5";g["1.2.840.113549.1.7.6"]="encryptedData";g.encryptedData="1.2.840.113549.1.7.6";g["1.2.840.113549.1.9.1"]="emailAddress";g.emailAddress="1.2.840.113549.1.9.1";g["1.2.840.113549.1.9.2"]="unstructuredName";g.unstructuredName="1.2.840.113549.1.9.2";g["1.2.840.113549.1.9.3"]="contentType";g.contentType="1.2.840.113549.1.9.3";g["1.2.840.113549.1.9.4"]="messageDigest";g.messageDigest="1.2.840.113549.1.9.4";g["1.2.840.113549.1.9.5"]="signingTime";g.signingTime="1.2.840.113549.1.9.5";g["1.2.840.113549.1.9.6"]="counterSignature";g.counterSignature="1.2.840.113549.1.9.6";g["1.2.840.113549.1.9.7"]="challengePassword";g.challengePassword="1.2.840.113549.1.9.7";g["1.2.840.113549.1.9.8"]="unstructuredAddress";g.unstructuredAddress="1.2.840.113549.1.9.8";g["1.2.840.113549.1.9.14"]="extensionRequest";g.extensionRequest="1.2.840.113549.1.9.14";g["1.2.840.113549.1.9.20"]="friendlyName";g.friendlyName="1.2.840.113549.1.9.20";g["1.2.840.113549.1.9.21"]="localKeyId";g.localKeyId="1.2.840.113549.1.9.21";g["1.2.840.113549.1.9.22.1"]="x509Certificate";g.x509Certificate="1.2.840.113549.1.9.22.1";g["1.2.840.113549.1.12.10.1.1"]="keyBag";g.keyBag="1.2.840.113549.1.12.10.1.1";g["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag";g.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2";g["1.2.840.113549.1.12.10.1.3"]="certBag";g.certBag="1.2.840.113549.1.12.10.1.3";g["1.2.840.113549.1.12.10.1.4"]="crlBag";g.crlBag="1.2.840.113549.1.12.10.1.4";g["1.2.840.113549.1.12.10.1.5"]="secretBag";g.secretBag="1.2.840.113549.1.12.10.1.5";g["1.2.840.113549.1.12.10.1.6"]="safeContentsBag";g.safeContentsBag="1.2.840.113549.1.12.10.1.6";g["1.2.840.113549.1.5.13"]="pkcs5PBES2";g.pkcs5PBES2="1.2.840.113549.1.5.13";g["1.2.840.113549.1.5.12"]="pkcs5PBKDF2";g.pkcs5PBKDF2="1.2.840.113549.1.5.12";g["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4";g.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1";g["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4";g.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2";g["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC";g["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3";g["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC";g["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4";g["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC";g["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5";g["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC";g["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6";g["1.2.840.113549.3.7"]="des-EDE3-CBC";g["des-EDE3-CBC"]="1.2.840.113549.3.7";g["2.16.840.1.101.3.4.1.2"]="aes128-CBC";g["aes128-CBC"]="2.16.840.1.101.3.4.1.2";g["2.16.840.1.101.3.4.1.22"]="aes192-CBC";g["aes192-CBC"]="2.16.840.1.101.3.4.1.22";g["2.16.840.1.101.3.4.1.42"]="aes256-CBC";g["aes256-CBC"]="2.16.840.1.101.3.4.1.42";g["2.5.4.3"]="commonName";g.commonName="2.5.4.3";g["2.5.4.5"]="serialName";g.serialName="2.5.4.5";g["2.5.4.6"]="countryName";g.countryName="2.5.4.6";g["2.5.4.7"]="localityName";g.localityName="2.5.4.7";g["2.5.4.8"]="stateOrProvinceName";g.stateOrProvinceName="2.5.4.8";g["2.5.4.10"]="organizationName";g.organizationName="2.5.4.10";g["2.5.4.11"]="organizationalUnitName";g.organizationalUnitName="2.5.4.11";g["2.16.840.1.113730.1.1"]="nsCertType";g.nsCertType="2.16.840.1.113730.1.1";g["2.5.29.1"]="authorityKeyIdentifier";g["2.5.29.2"]="keyAttributes";g["2.5.29.3"]="certificatePolicies";g["2.5.29.4"]="keyUsageRestriction";g["2.5.29.5"]="policyMapping";g["2.5.29.6"]="subtreesConstraint";g["2.5.29.7"]="subjectAltName";g["2.5.29.8"]="issuerAltName";g["2.5.29.9"]="subjectDirectoryAttributes";g["2.5.29.10"]="basicConstraints";g["2.5.29.11"]="nameConstraints";g["2.5.29.12"]="policyConstraints";g["2.5.29.13"]="basicConstraints";g["2.5.29.14"]="subjectKeyIdentifier";g.subjectKeyIdentifier="2.5.29.14";g["2.5.29.15"]="keyUsage";g.keyUsage="2.5.29.15";g["2.5.29.16"]="privateKeyUsagePeriod";g["2.5.29.17"]="subjectAltName";g.subjectAltName="2.5.29.17";g["2.5.29.18"]="issuerAltName";g.issuerAltName="2.5.29.18";g["2.5.29.19"]="basicConstraints";g.basicConstraints="2.5.29.19";g["2.5.29.20"]="cRLNumber";g["2.5.29.21"]="cRLReason";g["2.5.29.22"]="expirationDate";g["2.5.29.23"]="instructionCode";g["2.5.29.24"]="invalidityDate";g["2.5.29.25"]="cRLDistributionPoints";g["2.5.29.26"]="issuingDistributionPoint";g["2.5.29.27"]="deltaCRLIndicator";g["2.5.29.28"]="issuingDistributionPoint";g["2.5.29.29"]="certificateIssuer";g["2.5.29.30"]="nameConstraints";g["2.5.29.31"]="cRLDistributionPoints";g["2.5.29.32"]="certificatePolicies";g["2.5.29.33"]="policyMappings";g["2.5.29.34"]="policyConstraints";g["2.5.29.35"]="authorityKeyIdentifier";g["2.5.29.36"]="policyConstraints";g["2.5.29.37"]="extKeyUsage";g.extKeyUsage="2.5.29.37";g["2.5.29.46"]="freshestCRL";g["2.5.29.54"]="inhibitAnyPolicy";g["1.3.6.1.5.5.7.3.1"]="serverAuth";g.serverAuth="1.3.6.1.5.5.7.3.1";g["1.3.6.1.5.5.7.3.2"]="clientAuth";g.clientAuth="1.3.6.1.5.5.7.3.2";g["1.3.6.1.5.5.7.3.3"]="codeSigning";g.codeSigning="1.3.6.1.5.5.7.3.3";g["1.3.6.1.5.5.7.3.4"]="emailProtection";g.emailProtection="1.3.6.1.5.5.7.3.4";g["1.3.6.1.5.5.7.3.8"]="timeStamping";g.timeStamping="1.3.6.1.5.5.7.3.8"}var b="oids";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(t){if(typeof j==="undefined"){var j=t.jsbn.BigInteger}var l=t.asn1;t.pki=t.pki||{};t.pki.rsa=t.rsa=t.rsa||{};var o=t.pki;var v=[6,4,2,4,2,4,6,2];var p={name:"PrivateKeyInfo",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,value:[{name:"PrivateKeyInfo.version",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:false,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:l.Class.UNIVERSAL,type:l.Type.OCTETSTRING,constructed:false,capture:"privateKey"}]};var n={name:"RSAPrivateKey",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,value:[{name:"RSAPrivateKey.version",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyCoefficient"}]};var r={name:"RSAPublicKey",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,value:[{name:"RSAPublicKey.modulus",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"publicKeyExponent"}]};var s=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:false,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:false,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,optional:true,captureAsn1:"rsaPublicKey"}]}]};var q=function(z){var y;if(z.algorithm in o.oids){y=o.oids[z.algorithm]}else{var x=new Error("Unknown message digest algorithm.");x.algorithm=z.algorithm;throw x}var C=l.oidToDer(y).getBytes();var B=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[]);var w=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[]);w.value.push(l.create(l.Class.UNIVERSAL,l.Type.OID,false,C));w.value.push(l.create(l.Class.UNIVERSAL,l.Type.NULL,false,""));var A=l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,false,z.digest().getBytes());B.value.push(w);B.value.push(A);return l.toDer(B).getBytes()};var u=function(w,z,D){if(D){return w.modPow(z.e,z.n)}if(!z.p||!z.q){return w.modPow(z.d,z.n)}if(!z.dP){z.dP=z.d.mod(z.p.subtract(j.ONE))}if(!z.dQ){z.dQ=z.d.mod(z.q.subtract(j.ONE))}if(!z.qInv){z.qInv=z.q.modInverse(z.p)}var C;do{C=new j(t.util.bytesToHex(t.random.getBytes(z.n.bitLength()/8)),16).mod(z.n)}while(C.equals(j.ZERO));w=w.multiply(C.modPow(z.e,z.n)).mod(z.n);var B=w.mod(z.p).modPow(z.dP,z.p);var A=w.mod(z.q).modPow(z.dQ,z.q);while(B.compareTo(A)<0){B=B.add(z.p)}var E=B.subtract(A).multiply(z.qInv).mod(z.p).multiply(z.q).add(A);E=E.multiply(C.modInverse(z.n)).mod(z.n);return E};o.rsa.encrypt=function(z,H,I){var B=I;var D;var A=Math.ceil(H.n.bitLength()/8);if(I!==false&&I!==true){B=(I===2);D=m(z,H,I)}else{D=t.util.createBuffer();D.putBytes(z)}var G=new j(D.toHex(),16);var F=u(G,H,B);var E=F.toString(16);var C=t.util.createBuffer();var w=A-Math.ceil(E.length/2);while(w>0){C.putByte(0);--w}C.putBytes(t.util.hexToBytes(E));return C.getBytes()};o.rsa.decrypt=function(C,H,B,A){var z=Math.ceil(H.n.bitLength()/8);if(C.length!==z){var E=new Error("Encrypted message length is invalid.");E.length=C.length;E.expected=z;throw E}var F=new j(t.util.createBuffer(C).toHex(),16);if(F.compareTo(H.n)>=0){throw new Error("Encrypted message is invalid.")}var G=u(F,H,B);var I=G.toString(16);var D=t.util.createBuffer();var w=z-Math.ceil(I.length/2);while(w>0){D.putByte(0);--w}D.putBytes(t.util.hexToBytes(I));if(A!==false){return g(D.getBytes(),H,B)}return D.getBytes()};o.rsa.createKeyPairGenerationState=function(A,C,y){if(typeof(A)==="string"){A=parseInt(A,10)}A=A||2048;y=y||{};var z=y.prng||t.random;var w={nextBytes:function(E){var D=z.getBytesSync(E.length);for(var F=0;F<E.length;++F){E[F]=D.charCodeAt(F)}}};var x=y.algorithm||"PRIMEINC";var B;if(x==="PRIMEINC"){B={algorithm:x,state:0,bits:A,rng:w,eInt:C||65537,e:new j(null),p:null,q:null,qBits:A>>1,pBits:A-(A>>1),pqState:0,num:null,keys:null};B.e.fromInt(B.eInt)}else{throw new Error("Invalid key generation algorithm: "+x)}return B};o.rsa.stepKeyPairGenerationState=function(w,y){if(!("algorithm" in w)){w.algorithm="PRIMEINC"}var A=new j(null);A.fromInt(30);var C=0;var z=function(H,I){return H|I};var D=+new Date();var B;var F=0;while(w.keys===null&&(y<=0||F<y)){if(w.state===0){var G=(w.p===null)?w.pBits:w.qBits;var x=G-1;if(w.pqState===0){w.num=new j(G,w.rng);if(!w.num.testBit(x)){w.num.bitwiseTo(j.ONE.shiftLeft(x),z,w.num)}w.num.dAddOffset(31-w.num.mod(A).byteValue(),0);C=0;++w.pqState}else{if(w.pqState===1){if(w.num.bitLength()>G){w.pqState=0}else{if(w.num.isProbablePrime(k(w.num.bitLength()))){++w.pqState}else{w.num.dAddOffset(v[C++%8],0)}}}else{if(w.pqState===2){w.pqState=(w.num.subtract(j.ONE).gcd(w.e).compareTo(j.ONE)===0)?3:0}else{if(w.pqState===3){w.pqState=0;if(w.p===null){w.p=w.num}else{w.q=w.num}if(w.p!==null&&w.q!==null){++w.state}w.num=null}}}}}else{if(w.state===1){if(w.p.compareTo(w.q)<0){w.num=w.p;w.p=w.q;w.q=w.num}++w.state}else{if(w.state===2){w.p1=w.p.subtract(j.ONE);w.q1=w.q.subtract(j.ONE);w.phi=w.p1.multiply(w.q1);++w.state}else{if(w.state===3){if(w.phi.gcd(w.e).compareTo(j.ONE)===0){++w.state}else{w.p=null;w.q=null;w.state=0}}else{if(w.state===4){w.n=w.p.multiply(w.q);if(w.n.bitLength()===w.bits){++w.state}else{w.q=null;w.state=0}}else{if(w.state===5){var E=w.e.modInverse(w.phi);w.keys={privateKey:o.rsa.setPrivateKey(w.n,w.e,E,w.p,w.q,E.mod(w.p1),E.mod(w.q1),w.q.modInverse(w.p)),publicKey:o.rsa.setPublicKey(w.n,w.e)}}}}}}}B=+new Date();F+=B-D;D=B}return w.keys!==null};o.rsa.generateKeyPair=function(y,z,w,A){if(arguments.length===1){if(typeof y==="object"){w=y;y=undefined}else{if(typeof y==="function"){A=y;y=undefined}}}else{if(arguments.length===2){if(typeof y==="number"){if(typeof z==="function"){A=z;z=undefined}else{if(typeof z!=="number"){w=z;z=undefined}}}else{w=y;A=z;y=undefined;z=undefined}}else{if(arguments.length===3){if(typeof z==="number"){if(typeof w==="function"){A=w;w=undefined}}else{A=w;w=z;z=undefined}}}}w=w||{};if(y===undefined){y=w.bits||2048}if(z===undefined){z=w.e||65537}var x=o.rsa.createKeyPairGenerationState(y,z,w);if(!A){o.rsa.stepKeyPairGenerationState(x,0);return x.keys}i(x,w,A)};o.setRsaPublicKey=o.rsa.setPublicKey=function(y,x){var w={n:y,e:x};w.encrypt=function(B,A,z){if(typeof A==="string"){A=A.toUpperCase()}else{if(A===undefined){A="RSAES-PKCS1-V1_5"}}if(A==="RSAES-PKCS1-V1_5"){A={encode:function(D,E,F){return m(D,E,2).getBytes()}}}else{if(A==="RSA-OAEP"||A==="RSAES-OAEP"){A={encode:function(D,E){return t.pkcs1.encode_rsa_oaep(E,D,z)}}}else{if(["RAW","NONE","NULL",null].indexOf(A)!==-1){A={encode:function(D){return D}}}else{if(typeof A==="string"){throw new Error('Unsupported encryption scheme: "'+A+'".')}}}}var C=A.encode(B,w,true);return o.rsa.encrypt(C,w,true)};w.verify=function(C,z,A){if(typeof A==="string"){A=A.toUpperCase()}else{if(A===undefined){A="RSASSA-PKCS1-V1_5"}}if(A==="RSASSA-PKCS1-V1_5"){A={verify:function(F,E){E=g(E,w,true);var D=l.fromDer(E);return F===D.value[1].value}}}else{if(A==="NONE"||A==="NULL"||A===null){A={verify:function(E,D){D=g(D,w,true);return E===D}}}}var B=o.rsa.decrypt(z,w,true,false);return A.verify(C,B,w.n.bitLength())};return w};o.setRsaPrivateKey=o.rsa.setPrivateKey=function(y,z,A,x,w,C,B,E){var D={n:y,e:z,d:A,p:x,q:w,dP:C,dQ:B,qInv:E};D.decrypt=function(H,G,F){if(typeof G==="string"){G=G.toUpperCase()}else{if(G===undefined){G="RSAES-PKCS1-V1_5"}}var I=o.rsa.decrypt(H,D,false,false);if(G==="RSAES-PKCS1-V1_5"){G={decode:g}}else{if(G==="RSA-OAEP"||G==="RSAES-OAEP"){G={decode:function(K,J){return t.pkcs1.decode_rsa_oaep(J,K,F)}}}else{if(["RAW","NONE","NULL",null].indexOf(G)!==-1){G={decode:function(J){return J}}}else{throw new Error('Unsupported encryption scheme: "'+G+'".')}}}return G.decode(I,D,false)};D.sign=function(H,G){var F=false;if(typeof G==="string"){G=G.toUpperCase()}if(G===undefined||G==="RSASSA-PKCS1-V1_5"){G={encode:q};F=1}else{if(G==="NONE"||G==="NULL"||G===null){G={encode:function(){return H}};F=1}}var I=G.encode(H,D.n.bitLength());return o.rsa.encrypt(I,D,F)};return D};o.wrapRsaPrivateKey=function(w){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,l.integerToDer(0).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.OID,false,l.oidToDer(o.oids.rsaEncryption).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,false,"")]),l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,false,l.toDer(w).getBytes())])};o.privateKeyFromAsn1=function(z){var G={};var F=[];if(l.validate(z,p,G,F)){z=l.fromDer(t.util.createBuffer(G.privateKey))}G={};F=[];if(!l.validate(z,n,G,F)){var D=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");D.errors=F;throw D}var y,A,B,x,w,E,C,H;y=t.util.createBuffer(G.privateKeyModulus).toHex();A=t.util.createBuffer(G.privateKeyPublicExponent).toHex();B=t.util.createBuffer(G.privateKeyPrivateExponent).toHex();x=t.util.createBuffer(G.privateKeyPrime1).toHex();w=t.util.createBuffer(G.privateKeyPrime2).toHex();E=t.util.createBuffer(G.privateKeyExponent1).toHex();C=t.util.createBuffer(G.privateKeyExponent2).toHex();H=t.util.createBuffer(G.privateKeyCoefficient).toHex();return o.setRsaPrivateKey(new j(y,16),new j(A,16),new j(B,16),new j(x,16),new j(w,16),new j(E,16),new j(C,16),new j(H,16))};o.privateKeyToAsn1=o.privateKeyToRSAPrivateKey=function(w){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,l.integerToDer(0).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.n)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.e)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.d)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.p)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.q)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.dP)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.dQ)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.qInv))])};o.publicKeyFromAsn1=function(A){var w={};var C=[];if(l.validate(A,s,w,C)){var y=l.derToOid(w.publicKeyOid);if(y!==o.oids.rsaEncryption){var x=new Error("Cannot read public key. Unknown OID.");x.oid=y;throw x}A=w.rsaPublicKey}C=[];if(!l.validate(A,r,w,C)){var x=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");x.errors=C;throw x}var B=t.util.createBuffer(w.publicKeyModulus).toHex();var z=t.util.createBuffer(w.publicKeyExponent).toHex();return o.setRsaPublicKey(new j(B,16),new j(z,16))};o.publicKeyToAsn1=o.publicKeyToSubjectPublicKeyInfo=function(w){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.OID,false,l.oidToDer(o.oids.rsaEncryption).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,false,"")]),l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,false,[o.publicKeyToRSAPublicKey(w)])])};o.publicKeyToRSAPublicKey=function(w){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.n)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,h(w.e))])};function m(y,E,F){var C=t.util.createBuffer();var A=Math.ceil(E.n.bitLength()/8);if(y.length>(A-11)){var D=new Error("Message is too long for PKCS#1 v1.5 padding.");D.length=y.length;D.max=A-11;throw D}C.putByte(0);C.putByte(F);var z=A-3-y.length;var w;if(F===0||F===1){w=(F===0)?0:255;for(var B=0;B<z;++B){C.putByte(w)}}else{while(z>0){var x=0;var G=t.random.getBytes(z);for(var B=0;B<z;++B){w=G.charCodeAt(B);if(w===0){++x}else{C.putByte(w)}}z=x}}C.putByte(0);C.putBytes(y);return C}function g(w,F,A,z){var y=Math.ceil(F.n.bitLength()/8);var D=t.util.createBuffer(w);var C=D.getByte();var G=D.getByte();if(C!==0||(A&&G!==0&&G!==1)||(!A&&G!=2)||(A&&G===0&&typeof(z)==="undefined")){throw new Error("Encryption block is invalid.")}var x=0;if(G===0){x=y-3-z;for(var B=0;B<x;++B){if(D.getByte()!==0){throw new Error("Encryption block is invalid.")}}}else{if(G===1){x=0;while(D.length()>1){if(D.getByte()!==255){--D.read;break}++x}}else{if(G===2){x=0;while(D.length()>1){if(D.getByte()===0){--D.read;break}++x}}}}var E=D.getByte();if(E!==0||x!==(y-3-D.length())){throw new Error("Encryption block is invalid.")}return D.getBytes()}function i(A,x,C){if(typeof x==="function"){C=x;x={}}x=x||{};var z={algorithm:{name:x.algorithm||"PRIMEINC",options:{workers:x.workers||2,workLoad:x.workLoad||100,workerScript:x.workerScript}}};if("prng" in x){z.prng=x.prng}w();function w(){B(A.pBits,function(E,D){if(E){return C(E)}A.p=D;if(A.q!==null){return y(E,A.q)}B(A.qBits,y)})}function B(D,E){t.prime.generateProbablePrime(D,z,E)}function y(F,D){if(F){return C(F)}A.q=D;if(A.p.compareTo(A.q)<0){var E=A.p;A.p=A.q;A.q=E}if(A.p.subtract(j.ONE).gcd(A.e).compareTo(j.ONE)!==0){A.p=null;w();return}if(A.q.subtract(j.ONE).gcd(A.e).compareTo(j.ONE)!==0){A.q=null;B(A.qBits,y);return}A.p1=A.p.subtract(j.ONE);A.q1=A.q.subtract(j.ONE);A.phi=A.p1.multiply(A.q1);if(A.phi.gcd(A.e).compareTo(j.ONE)!==0){A.p=A.q=null;w();return}A.n=A.p.multiply(A.q);if(A.n.bitLength()!==A.bits){A.q=null;B(A.qBits,y);return}var G=A.e.modInverse(A.phi);A.keys={privateKey:o.rsa.setPrivateKey(A.n,A.e,G,A.p,A.q,G.mod(A.p1),G.mod(A.q1),A.q.modInverse(A.p)),publicKey:o.rsa.setPublicKey(A.n,A.e)};C(null,A.keys)}}function h(w){var x=w.toString(16);if(x[0]>="8"){x="00"+x}return t.util.hexToBytes(x)}function k(w){if(w<=100){return 27}if(w<=150){return 18}if(w<=200){return 15}if(w<=250){return 12}if(w<=300){return 9}if(w<=350){return 8}if(w<=400){return 7}if(w<=500){return 6}if(w<=600){return 5}if(w<=800){return 4}if(w<=1250){return 3}return 2}}var b="rsa";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./asn1","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(p){var r=p.asn1;var j=p.pki=p.pki||{};var l=j.oids;var t={};t.CN=l.commonName;t.commonName="CN";t.C=l.countryName;t.countryName="C";t.L=l.localityName;t.localityName="L";t.ST=l.stateOrProvinceName;t.stateOrProvinceName="ST";t.O=l.organizationName;t.organizationName="O";t.OU=l.organizationalUnitName;t.organizationalUnitName="OU";t.E=l.emailAddress;t.emailAddress="E";var v=p.pki.rsa.publicKeyValidator;var u={name:"Certificate",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:r.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:false,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:false,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:false,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:r.Class.UNIVERSAL,optional:true,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:r.Class.UNIVERSAL,type:r.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:r.Class.UNIVERSAL,type:r.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:r.Class.UNIVERSAL,type:r.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:r.Class.UNIVERSAL,type:r.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,captureAsn1:"certSubject"},v,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:r.Class.CONTEXT_SPECIFIC,type:1,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:r.Class.UNIVERSAL,type:r.Type.BITSTRING,constructed:false,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:r.Class.CONTEXT_SPECIFIC,type:2,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:r.Class.UNIVERSAL,type:r.Type.BITSTRING,constructed:false,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:r.Class.CONTEXT_SPECIFIC,type:3,constructed:true,captureAsn1:"certExtensions",optional:true}]},{name:"Certificate.signatureAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:false,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:r.Class.UNIVERSAL,optional:true,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:r.Class.UNIVERSAL,type:r.Type.BITSTRING,constructed:false,capture:"certSignature"}]};var s={name:"rsapss",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.hashAlgorithm",tagClass:r.Class.CONTEXT_SPECIFIC,type:0,constructed:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:r.Class.UNIVERSAL,type:r.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:false,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:r.Class.CONTEXT_SPECIFIC,type:1,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:r.Class.UNIVERSAL,type:r.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:false,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:false,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:r.Class.CONTEXT_SPECIFIC,type:2,optional:true,value:[{name:"rsapss.saltLength.saltLength",tagClass:r.Class.UNIVERSAL,type:r.Class.INTEGER,constructed:false,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:r.Class.CONTEXT_SPECIFIC,type:3,optional:true,value:[{name:"rsapss.trailer.trailer",tagClass:r.Class.UNIVERSAL,type:r.Class.INTEGER,constructed:false,capture:"trailer"}]}]};var k={name:"CertificationRequestInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:false,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfoSubject"},v,{name:"CertificationRequestInfo.attributes",tagClass:r.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:false},{name:"CertificationRequestInfo.attributes.value",tagClass:r.Class.UNIVERSAL,type:r.Type.SET,constructed:true}]}]}]};var q={name:"CertificationRequest",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,captureAsn1:"csr",value:[k,{name:"CertificationRequest.signatureAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:false,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:r.Class.UNIVERSAL,optional:true,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:r.Class.UNIVERSAL,type:r.Type.BITSTRING,constructed:false,capture:"csrSignature"}]};j.RDNAttributesAsArray=function(C,B){var E=[];var F,y,D;for(var z=0;z<C.value.length;++z){F=C.value[z];for(var A=0;A<F.value.length;++A){D={};y=F.value[A];D.type=r.derToOid(y.value[0].value);D.value=y.value[1].value;D.valueTagClass=y.value[1].type;if(D.type in l){D.name=l[D.type];if(D.name in t){D.shortName=t[D.name]}}if(B){B.update(D.type);B.update(D.value)}E.push(D)}}return E};j.CRIAttributesAsArray=function(A){var D=[];for(var C=0;C<A.length;++C){var G=A[C];var E=r.derToOid(G.value[0].value);var F=G.value[1].value;for(var z=0;z<F.length;++z){var B={};B.type=E;B.value=F[z].value;B.valueTagClass=F[z].type;if(B.type in l){B.name=l[B.type];if(B.name in t){B.shortName=t[B.name]}}if(B.type===l.extensionRequest){B.extensions=[];for(var y=0;y<B.value.length;++y){B.extensions.push(j.certificateExtensionFromAsn1(B.value[y]))}}D.push(B)}}return D};function i(C,z){if(typeof z==="string"){z={shortName:z}}var B=null;var y;for(var A=0;B===null&&A<C.attributes.length;++A){y=C.attributes[A];if(z.type&&z.type===y.type){B=y}else{if(z.name&&z.name===y.name){B=y}else{if(z.shortName&&z.shortName===y.shortName){B=y}}}}return B}var h=function(B,C,y){var D={};if(B!==l["RSASSA-PSS"]){return D}if(y){D={hash:{algorithmOid:l.sha1},mgf:{algorithmOid:l.mgf1,hash:{algorithmOid:l.sha1}},saltLength:20}}var z={};var E=[];if(!r.validate(C,s,z,E)){var A=new Error("Cannot read RSASSA-PSS parameter block.");A.errors=E;throw A}if(z.hashOid!==undefined){D.hash=D.hash||{};D.hash.algorithmOid=r.derToOid(z.hashOid)}if(z.maskGenOid!==undefined){D.mgf=D.mgf||{};D.mgf.algorithmOid=r.derToOid(z.maskGenOid);D.mgf.hash=D.mgf.hash||{};D.mgf.hash.algorithmOid=r.derToOid(z.maskGenHashOid)}if(z.saltLength!==undefined){D.saltLength=z.saltLength.charCodeAt(0)}return D};j.certificateFromPem=function(A,D,y){var C=p.pem.decode(A)[0];if(C.type!=="CERTIFICATE"&&C.type!=="X509 CERTIFICATE"&&C.type!=="TRUSTED CERTIFICATE"){var z=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');z.headerType=C.type;throw z}if(C.procType&&C.procType.type==="ENCRYPTED"){throw new Error("Could not convert certificate from PEM; PEM is encrypted.")}var B=r.fromDer(C.body,y);return j.certificateFromAsn1(B,D)};j.certificateToPem=function(y,A){var z={type:"CERTIFICATE",body:r.toDer(j.certificateToAsn1(y)).getBytes()};return p.pem.encode(z,{maxline:A})};j.publicKeyFromPem=function(z){var B=p.pem.decode(z)[0];if(B.type!=="PUBLIC KEY"&&B.type!=="RSA PUBLIC KEY"){var y=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');y.headerType=B.type;throw y}if(B.procType&&B.procType.type==="ENCRYPTED"){throw new Error("Could not convert public key from PEM; PEM is encrypted.")}var A=r.fromDer(B.body);return j.publicKeyFromAsn1(A)};j.publicKeyToPem=function(y,A){var z={type:"PUBLIC KEY",body:r.toDer(j.publicKeyToAsn1(y)).getBytes()};return p.pem.encode(z,{maxline:A})};j.publicKeyToRSAPublicKeyPem=function(y,A){var z={type:"RSA PUBLIC KEY",body:r.toDer(j.publicKeyToRSAPublicKey(y)).getBytes()};return p.pem.encode(z,{maxline:A})};j.getPublicKeyFingerprint=function(A,z){z=z||{};var D=z.md||p.md.sha1.create();var B=z.type||"RSAPublicKey";var y;switch(B){case"RSAPublicKey":y=r.toDer(j.publicKeyToRSAPublicKey(A)).getBytes();break;case"SubjectPublicKeyInfo":y=r.toDer(j.publicKeyToAsn1(A)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+z.type+'".')}D.start();D.update(y);var E=D.digest();if(z.encoding==="hex"){var C=E.toHex();if(z.delimiter){return C.match(/.{2}/g).join(z.delimiter)}return C}else{if(z.encoding==="binary"){return E.getBytes()}else{if(z.encoding){throw new Error('Unknown encoding "'+z.encoding+'".')}}}return E};j.certificationRequestFromPem=function(A,D,y){var C=p.pem.decode(A)[0];if(C.type!=="CERTIFICATE REQUEST"){var z=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');z.headerType=C.type;throw z}if(C.procType&&C.procType.type==="ENCRYPTED"){throw new Error("Could not convert certification request from PEM; PEM is encrypted.")}var B=r.fromDer(C.body,y);return j.certificationRequestFromAsn1(B,D)};j.certificationRequestToPem=function(y,A){var z={type:"CERTIFICATE REQUEST",body:r.toDer(j.certificationRequestToAsn1(y)).getBytes()};return p.pem.encode(z,{maxline:A})};j.createCertificate=function(){var y={};y.version=2;y.serialNumber="00";y.signatureOid=null;y.signature=null;y.siginfo={};y.siginfo.algorithmOid=null;y.validity={};y.validity.notBefore=new Date();y.validity.notAfter=new Date();y.issuer={};y.issuer.getField=function(z){return i(y.issuer,z)};y.issuer.addField=function(z){m([z]);y.issuer.attributes.push(z)};y.issuer.attributes=[];y.issuer.hash=null;y.subject={};y.subject.getField=function(z){return i(y.subject,z)};y.subject.addField=function(z){m([z]);y.subject.attributes.push(z)};y.subject.attributes=[];y.subject.hash=null;y.extensions=[];y.publicKey=null;y.md=null;y.setSubject=function(z,A){m(z);y.subject.attributes=z;delete y.subject.uniqueId;if(A){y.subject.uniqueId=A}y.subject.hash=null};y.setIssuer=function(z,A){m(z);y.issuer.attributes=z;delete y.issuer.uniqueId;if(A){y.issuer.uniqueId=A}y.issuer.hash=null};y.setExtensions=function(A){for(var z=0;z<A.length;++z){n(A[z],{cert:y})}y.extensions=A};y.getExtension=function(z){if(typeof z==="string"){z={name:z}}var C=null;var B;for(var A=0;C===null&&A<y.extensions.length;++A){B=y.extensions[A];if(z.id&&B.id===z.id){C=B}else{if(z.name&&B.name===z.name){C=B}}}return C};y.sign=function(B,C){y.md=C||p.md.sha1.create();var D=l[y.md.algorithm+"WithRSAEncryption"];if(!D){var A=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");A.algorithm=y.md.algorithm;throw A}y.signatureOid=y.siginfo.algorithmOid=D;y.tbsCertificate=j.getTBSCertificate(y);var z=r.toDer(y.tbsCertificate);y.md.update(z.getBytes());y.signature=B.sign(y.md)};y.verify=function(A){var E=false;if(!y.issued(A)){var F=A.issuer;var G=y.subject;var H=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");H.expectedIssuer=F.attributes;H.actualIssuer=G.attributes;throw H}var I=A.md;if(I===null){if(A.signatureOid in l){var B=l[A.signatureOid];switch(B){case"sha1WithRSAEncryption":I=p.md.sha1.create();break;case"md5WithRSAEncryption":I=p.md.md5.create();break;case"sha256WithRSAEncryption":I=p.md.sha256.create();break;case"RSASSA-PSS":I=p.md.sha256.create();break}}if(I===null){var H=new Error("Could not compute certificate digest. Unknown signature OID.");H.signatureOid=A.signatureOid;throw H}var J=A.tbsCertificate||j.getTBSCertificate(A);var K=r.toDer(J);I.update(K.getBytes())}if(I!==null){var z;switch(A.signatureOid){case l.sha1WithRSAEncryption:z=undefined;break;case l["RSASSA-PSS"]:var D,C;D=l[A.signatureParameters.mgf.hash.algorithmOid];if(D===undefined||p.md[D]===undefined){var H=new Error("Unsupported MGF hash function.");H.oid=A.signatureParameters.mgf.hash.algorithmOid;H.name=D;throw H}C=l[A.signatureParameters.mgf.algorithmOid];if(C===undefined||p.mgf[C]===undefined){var H=new Error("Unsupported MGF function.");H.oid=A.signatureParameters.mgf.algorithmOid;H.name=C;throw H}C=p.mgf[C].create(p.md[D].create());D=l[A.signatureParameters.hash.algorithmOid];if(D===undefined||p.md[D]===undefined){throw {message:"Unsupported RSASSA-PSS hash function.",oid:A.signatureParameters.hash.algorithmOid,name:D}}z=p.pss.create(p.md[D].create(),C,A.signatureParameters.saltLength);break}E=y.publicKey.verify(I.digest().getBytes(),A.signature,z)}return E};y.isIssuer=function(C){var E=false;var A=y.issuer;var B=C.subject;if(A.hash&&B.hash){E=(A.hash===B.hash)}else{if(A.attributes.length===B.attributes.length){E=true;var z,D;for(var F=0;E&&F<A.attributes.length;++F){z=A.attributes[F];D=B.attributes[F];if(z.type!==D.type||z.value!==D.value){E=false}}}}return E};y.issued=function(z){return z.isIssuer(y)};y.generateSubjectKeyIdentifier=function(){return j.getPublicKeyFingerprint(y.publicKey,{type:"RSAPublicKey"})};y.verifySubjectKeyIdentifier=function(){var C=l.subjectKeyIdentifier;for(var A=0;A<y.extensions.length;++A){var B=y.extensions[A];if(B.id===C){var z=y.generateSubjectKeyIdentifier().getBytes();return(p.util.hexToBytes(B.subjectKeyIdentifier)===z)}}return false};return y};j.certificateFromAsn1=function(D,K){var L={};var J=[];if(!r.validate(D,u,L,J)){var H=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");H.errors=J;throw H}if(typeof L.certSignature!=="string"){var B="\x00";for(var E=0;E<L.certSignature.length;++E){B+=r.toDer(L.certSignature[E]).getBytes()}L.certSignature=B}var A=r.derToOid(L.publicKeyOid);if(A!==j.oids.rsaEncryption){throw new Error("Cannot read public key. OID is not RSA.")}var C=j.createCertificate();C.version=L.certVersion?L.certVersion.charCodeAt(0):0;var y=p.util.createBuffer(L.certSerialNumber);C.serialNumber=y.toHex();C.signatureOid=p.asn1.derToOid(L.certSignatureOid);C.signatureParameters=h(C.signatureOid,L.certSignatureParams,true);C.siginfo.algorithmOid=p.asn1.derToOid(L.certinfoSignatureOid);C.siginfo.parameters=h(C.siginfo.algorithmOid,L.certinfoSignatureParams,false);var z=p.util.createBuffer(L.certSignature);++z.read;C.signature=z.getBytes();var G=[];if(L.certValidity1UTCTime!==undefined){G.push(r.utcTimeToDate(L.certValidity1UTCTime))}if(L.certValidity2GeneralizedTime!==undefined){G.push(r.generalizedTimeToDate(L.certValidity2GeneralizedTime))}if(L.certValidity3UTCTime!==undefined){G.push(r.utcTimeToDate(L.certValidity3UTCTime))}if(L.certValidity4GeneralizedTime!==undefined){G.push(r.generalizedTimeToDate(L.certValidity4GeneralizedTime))}if(G.length>2){throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.")}if(G.length<2){throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.")}C.validity.notBefore=G[0];C.validity.notAfter=G[1];C.tbsCertificate=L.tbsCertificate;if(K){C.md=null;if(C.signatureOid in l){var A=l[C.signatureOid];switch(A){case"sha1WithRSAEncryption":C.md=p.md.sha1.create();break;case"md5WithRSAEncryption":C.md=p.md.md5.create();break;case"sha256WithRSAEncryption":C.md=p.md.sha256.create();break;case"RSASSA-PSS":C.md=p.md.sha256.create();break}}if(C.md===null){var H=new Error("Could not compute certificate digest. Unknown signature OID.");H.signatureOid=C.signatureOid;throw H}var M=r.toDer(C.tbsCertificate);C.md.update(M.getBytes())}var F=p.md.sha1.create();C.issuer.getField=function(N){return i(C.issuer,N)};C.issuer.addField=function(N){m([N]);C.issuer.attributes.push(N)};C.issuer.attributes=j.RDNAttributesAsArray(L.certIssuer,F);if(L.certIssuerUniqueId){C.issuer.uniqueId=L.certIssuerUniqueId}C.issuer.hash=F.digest().toHex();var I=p.md.sha1.create();C.subject.getField=function(N){return i(C.subject,N)};C.subject.addField=function(N){m([N]);C.subject.attributes.push(N)};C.subject.attributes=j.RDNAttributesAsArray(L.certSubject,I);if(L.certSubjectUniqueId){C.subject.uniqueId=L.certSubjectUniqueId}C.subject.hash=I.digest().toHex();if(L.certExtensions){C.extensions=j.certificateExtensionsFromAsn1(L.certExtensions)}else{C.extensions=[]}C.publicKey=j.publicKeyFromAsn1(L.subjectPublicKeyInfo);return C};j.certificateExtensionsFromAsn1=function(A){var C=[];for(var z=0;z<A.value.length;++z){var y=A.value[z];for(var B=0;B<y.value.length;++B){C.push(j.certificateExtensionFromAsn1(y.value[B]))}}return C};j.certificateExtensionFromAsn1=function(z){var E={};E.id=r.derToOid(z.value[0].value);E.critical=false;if(z.value[1].type===r.Type.BOOLEAN){E.critical=(z.value[1].value.charCodeAt(0)!==0);E.value=z.value[2].value}else{E.value=z.value[1].value}if(E.id in l){E.name=l[E.id];if(E.name==="keyUsage"){var G=r.fromDer(E.value);var H=0;var F=0;if(G.value.length>1){H=G.value.charCodeAt(1);F=G.value.length>2?G.value.charCodeAt(2):0}E.digitalSignature=(H&128)===128;E.nonRepudiation=(H&64)===64;E.keyEncipherment=(H&32)===32;E.dataEncipherment=(H&16)===16;E.keyAgreement=(H&8)===8;E.keyCertSign=(H&4)===4;E.cRLSign=(H&2)===2;E.encipherOnly=(H&1)===1;E.decipherOnly=(F&128)===128}else{if(E.name==="basicConstraints"){var G=r.fromDer(E.value);if(G.value.length>0&&G.value[0].type===r.Type.BOOLEAN){E.cA=(G.value[0].value.charCodeAt(0)!==0)}else{E.cA=false}var I=null;if(G.value.length>0&&G.value[0].type===r.Type.INTEGER){I=G.value[0].value}else{if(G.value.length>1){I=G.value[1].value}}if(I!==null){E.pathLenConstraint=r.derToInteger(I)}}else{if(E.name==="extKeyUsage"){var G=r.fromDer(E.value);for(var D=0;D<G.value.length;++D){var B=r.derToOid(G.value[D].value);if(B in l){E[l[B]]=true}else{E[B]=true}}}else{if(E.name==="nsCertType"){var G=r.fromDer(E.value);var H=0;if(G.value.length>1){H=G.value.charCodeAt(1)}E.client=(H&128)===128;E.server=(H&64)===64;E.email=(H&32)===32;E.objsign=(H&16)===16;E.reserved=(H&8)===8;E.sslCA=(H&4)===4;E.emailCA=(H&2)===2;E.objCA=(H&1)===1}else{if(E.name==="subjectAltName"||E.name==="issuerAltName"){E.altNames=[];var C;var G=r.fromDer(E.value);for(var A=0;A<G.value.length;++A){C=G.value[A];var y={type:C.type,value:C.value};E.altNames.push(y);switch(C.type){case 1:case 2:case 6:break;case 7:y.ip=p.util.bytesToIP(C.value);break;case 8:y.oid=r.derToOid(C.value);break;default:}}}else{if(E.name==="subjectKeyIdentifier"){var G=r.fromDer(E.value);E.subjectKeyIdentifier=p.util.bytesToHex(G.value)}}}}}}}return E};j.certificationRequestFromAsn1=function(A,H){var I={};var G=[];if(!r.validate(A,q,I,G)){var E=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");E.errors=G;throw E}if(typeof I.csrSignature!=="string"){var D="\x00";for(var B=0;B<I.csrSignature.length;++B){D+=r.toDer(I.csrSignature[B]).getBytes()}I.csrSignature=D}var z=r.derToOid(I.publicKeyOid);if(z!==j.oids.rsaEncryption){throw new Error("Cannot read public key. OID is not RSA.")}var C=j.createCertificationRequest();C.version=I.csrVersion?I.csrVersion.charCodeAt(0):0;C.signatureOid=p.asn1.derToOid(I.csrSignatureOid);C.signatureParameters=h(C.signatureOid,I.csrSignatureParams,true);C.siginfo.algorithmOid=p.asn1.derToOid(I.csrSignatureOid);C.siginfo.parameters=h(C.siginfo.algorithmOid,I.csrSignatureParams,false);var y=p.util.createBuffer(I.csrSignature);++y.read;C.signature=y.getBytes();C.certificationRequestInfo=I.certificationRequestInfo;if(H){C.md=null;if(C.signatureOid in l){var z=l[C.signatureOid];switch(z){case"sha1WithRSAEncryption":C.md=p.md.sha1.create();break;case"md5WithRSAEncryption":C.md=p.md.md5.create();break;case"sha256WithRSAEncryption":C.md=p.md.sha256.create();break;case"RSASSA-PSS":C.md=p.md.sha256.create();break}}if(C.md===null){var E=new Error("Could not compute certification request digest. Unknown signature OID.");E.signatureOid=C.signatureOid;throw E}var J=r.toDer(C.certificationRequestInfo);C.md.update(J.getBytes())}var F=p.md.sha1.create();C.subject.getField=function(K){return i(C.subject,K)};C.subject.addField=function(K){m([K]);C.subject.attributes.push(K)};C.subject.attributes=j.RDNAttributesAsArray(I.certificationRequestInfoSubject,F);C.subject.hash=F.digest().toHex();C.publicKey=j.publicKeyFromAsn1(I.subjectPublicKeyInfo);C.getAttribute=function(K){return i(C,K)};C.addAttribute=function(K){m([K]);C.attributes.push(K)};C.attributes=j.CRIAttributesAsArray(I.certificationRequestInfoAttributes||[]);return C};j.createCertificationRequest=function(){var y={};y.version=0;y.signatureOid=null;y.signature=null;y.siginfo={};y.siginfo.algorithmOid=null;y.subject={};y.subject.getField=function(z){return i(y.subject,z)};y.subject.addField=function(z){m([z]);y.subject.attributes.push(z)};y.subject.attributes=[];y.subject.hash=null;y.publicKey=null;y.attributes=[];y.getAttribute=function(z){return i(y,z)};y.addAttribute=function(z){m([z]);y.attributes.push(z)};y.md=null;y.setSubject=function(z){m(z);y.subject.attributes=z;y.subject.hash=null};y.setAttributes=function(z){m(z);y.attributes=z};y.sign=function(B,C){y.md=C||p.md.sha1.create();var D=l[y.md.algorithm+"WithRSAEncryption"];if(!D){var A=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");A.algorithm=y.md.algorithm;throw A}y.signatureOid=y.siginfo.algorithmOid=D;y.certificationRequestInfo=j.getCertificationRequestInfo(y);var z=r.toDer(y.certificationRequestInfo);y.md.update(z.getBytes());y.signature=B.sign(y.md)};y.verify=function(){var E=false;var G=y.md;if(G===null){if(y.signatureOid in l){var A=l[y.signatureOid];switch(A){case"sha1WithRSAEncryption":G=p.md.sha1.create();break;case"md5WithRSAEncryption":G=p.md.md5.create();break;case"sha256WithRSAEncryption":G=p.md.sha256.create();break;case"RSASSA-PSS":G=p.md.sha256.create();break}}if(G===null){var F=new Error("Could not compute certification request digest. Unknown signature OID.");F.signatureOid=y.signatureOid;throw F}var B=y.certificationRequestInfo||j.getCertificationRequestInfo(y);var H=r.toDer(B);G.update(H.getBytes())}if(G!==null){var z;switch(y.signatureOid){case l.sha1WithRSAEncryption:break;case l["RSASSA-PSS"]:var D,C;D=l[y.signatureParameters.mgf.hash.algorithmOid];if(D===undefined||p.md[D]===undefined){var F=new Error("Unsupported MGF hash function.");F.oid=y.signatureParameters.mgf.hash.algorithmOid;F.name=D;throw F}C=l[y.signatureParameters.mgf.algorithmOid];if(C===undefined||p.mgf[C]===undefined){var F=new Error("Unsupported MGF function.");F.oid=y.signatureParameters.mgf.algorithmOid;F.name=C;throw F}C=p.mgf[C].create(p.md[D].create());D=l[y.signatureParameters.hash.algorithmOid];if(D===undefined||p.md[D]===undefined){var F=new Error("Unsupported RSASSA-PSS hash function.");F.oid=y.signatureParameters.hash.algorithmOid;F.name=D;throw F}z=p.pss.create(p.md[D].create(),C,y.signatureParameters.saltLength);break}E=y.publicKey.verify(G.digest().getBytes(),y.signature,z)}return E};return y};function o(E){var D=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[]);var y,F;var z=E.attributes;for(var A=0;A<z.length;++A){y=z[A];var C=y.value;var B=r.Type.PRINTABLESTRING;if("valueTagClass" in y){B=y.valueTagClass;if(B===r.Type.UTF8){C=p.util.encodeUtf8(C)}}F=r.create(r.Class.UNIVERSAL,r.Type.SET,true,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(y.type).getBytes()),r.create(r.Class.UNIVERSAL,B,false,C)])]);D.value.push(F)}return D}function g(z){var C={};for(var A=0;A<z.length;++A){var y=z[A];if(y.shortName&&(y.valueTagClass===r.Type.UTF8||y.valueTagClass===r.Type.PRINTABLESTRING||y.valueTagClass===r.Type.IA5STRING)){var B=y.value;if(y.valueTagClass===r.Type.UTF8){B=p.util.encodeUtf8(y.value)}if(!(y.shortName in C)){C[y.shortName]=B}else{if(p.util.isArray(C[y.shortName])){C[y.shortName].push(B)}else{C[y.shortName]=[C[y.shortName],B]}}}}return C}function m(A){var y;for(var B=0;B<A.length;++B){y=A[B];if(typeof y.name==="undefined"){if(y.type&&y.type in j.oids){y.name=j.oids[y.type]}else{if(y.shortName&&y.shortName in t){y.name=j.oids[t[y.shortName]]}}}if(typeof y.type==="undefined"){if(y.name&&y.name in j.oids){y.type=j.oids[y.name]}else{var z=new Error("Attribute type not specified.");z.attribute=y;throw z}}if(typeof y.shortName==="undefined"){if(y.name&&y.name in t){y.shortName=t[y.name]}}if(y.type===l.extensionRequest){y.valueConstructed=true;y.valueTagClass=r.Type.SEQUENCE;if(!y.value&&y.extensions){y.value=[];for(var C=0;C<y.extensions.length;++C){y.value.push(j.certificateExtensionToAsn1(n(y.extensions[C])))}}}if(typeof y.value==="undefined"){var z=new Error("Attribute value not specified.");z.attribute=y;throw z}}}function n(C,J){J=J||{};if(typeof C.name==="undefined"){if(C.id&&C.id in j.oids){C.name=j.oids[C.id]}}if(typeof C.id==="undefined"){if(C.name&&C.name in j.oids){C.id=j.oids[C.name]}else{var D=new Error("Extension ID not specified.");D.extension=C;throw D}}if(typeof C.value!=="undefined"){return C}if(C.name==="keyUsage"){var B=0;var F=0;var E=0;if(C.digitalSignature){F|=128;B=7}if(C.nonRepudiation){F|=64;B=6}if(C.keyEncipherment){F|=32;B=5}if(C.dataEncipherment){F|=16;B=4}if(C.keyAgreement){F|=8;B=3}if(C.keyCertSign){F|=4;B=2}if(C.cRLSign){F|=2;B=1}if(C.encipherOnly){F|=1;B=0}if(C.decipherOnly){E|=128;B=7}var G=String.fromCharCode(B);if(E!==0){G+=String.fromCharCode(F)+String.fromCharCode(E)}else{if(F!==0){G+=String.fromCharCode(F)}}C.value=r.create(r.Class.UNIVERSAL,r.Type.BITSTRING,false,G)}else{if(C.name==="basicConstraints"){C.value=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[]);if(C.cA){C.value.value.push(r.create(r.Class.UNIVERSAL,r.Type.BOOLEAN,false,String.fromCharCode(255)))}if("pathLenConstraint" in C){C.value.value.push(r.create(r.Class.UNIVERSAL,r.Type.INTEGER,false,r.integerToDer(C.pathLenConstraint).getBytes()))}}else{if(C.name==="extKeyUsage"){C.value=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[]);var I=C.value.value;for(var H in C){if(C[H]!==true){continue}if(H in l){I.push(r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(l[H]).getBytes()))}else{if(H.indexOf(".")!==-1){I.push(r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(H).getBytes()))}}}}else{if(C.name==="nsCertType"){var B=0;var F=0;if(C.client){F|=128;B=7}if(C.server){F|=64;B=6}if(C.email){F|=32;B=5}if(C.objsign){F|=16;B=4}if(C.reserved){F|=8;B=3}if(C.sslCA){F|=4;B=2}if(C.emailCA){F|=2;B=1}if(C.objCA){F|=1;B=0}var G=String.fromCharCode(B);if(F!==0){G+=String.fromCharCode(F)}C.value=r.create(r.Class.UNIVERSAL,r.Type.BITSTRING,false,G)}else{if(C.name==="subjectAltName"||C.name==="issuerAltName"){C.value=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[]);var y;for(var A=0;A<C.altNames.length;++A){y=C.altNames[A];var G=y.value;if(y.type===7&&y.ip){G=p.util.bytesFromIP(y.ip);if(G===null){var D=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');D.extension=C;throw D}}else{if(y.type===8){if(y.oid){G=r.oidToDer(r.oidToDer(y.oid))}else{G=r.oidToDer(G)}}}C.value.value.push(r.create(r.Class.CONTEXT_SPECIFIC,y.type,false,G))}}else{if(C.name==="subjectKeyIdentifier"&&J.cert){var z=J.cert.generateSubjectKeyIdentifier();C.subjectKeyIdentifier=z.toHex();C.value=r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,false,z.getBytes())}}}}}}if(typeof C.value==="undefined"){var D=new Error("Extension value not specified.");D.extension=C;throw D}return C}function w(y,A){switch(y){case l["RSASSA-PSS"]:var z=[];if(A.hash.algorithmOid!==undefined){z.push(r.create(r.Class.CONTEXT_SPECIFIC,0,true,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(A.hash.algorithmOid).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.NULL,false,"")])]))}if(A.mgf.algorithmOid!==undefined){z.push(r.create(r.Class.CONTEXT_SPECIFIC,1,true,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(A.mgf.algorithmOid).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(A.mgf.hash.algorithmOid).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.NULL,false,"")])])]))}if(A.saltLength!==undefined){z.push(r.create(r.Class.CONTEXT_SPECIFIC,2,true,[r.create(r.Class.UNIVERSAL,r.Type.INTEGER,false,r.integerToDer(A.saltLength).getBytes())]))}return r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,z);default:return r.create(r.Class.UNIVERSAL,r.Type.NULL,false,"")}}function x(B){var A=r.create(r.Class.CONTEXT_SPECIFIC,0,true,[]);if(B.attributes.length===0){return A}var F=B.attributes;for(var z=0;z<F.length;++z){var C=F[z];var D=C.value;var E=r.Type.UTF8;if("valueTagClass" in C){E=C.valueTagClass}if(E===r.Type.UTF8){D=p.util.encodeUtf8(D)}var y=false;if("valueConstructed" in C){y=C.valueConstructed}var G=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(C.type).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SET,true,[r.create(r.Class.UNIVERSAL,E,y,D)])]);A.value.push(G)}return A}j.getTBSCertificate=function(z){var y=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.CONTEXT_SPECIFIC,0,true,[r.create(r.Class.UNIVERSAL,r.Type.INTEGER,false,r.integerToDer(z.version).getBytes())]),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,false,p.util.hexToBytes(z.serialNumber)),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(z.siginfo.algorithmOid).getBytes()),w(z.siginfo.algorithmOid,z.siginfo.parameters)]),o(z.issuer),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.UTCTIME,false,r.dateToUtcTime(z.validity.notBefore)),r.create(r.Class.UNIVERSAL,r.Type.UTCTIME,false,r.dateToUtcTime(z.validity.notAfter))]),o(z.subject),j.publicKeyToAsn1(z.publicKey)]);if(z.issuer.uniqueId){y.value.push(r.create(r.Class.CONTEXT_SPECIFIC,1,true,[r.create(r.Class.UNIVERSAL,r.Type.BITSTRING,false,String.fromCharCode(0)+z.issuer.uniqueId)]))}if(z.subject.uniqueId){y.value.push(r.create(r.Class.CONTEXT_SPECIFIC,2,true,[r.create(r.Class.UNIVERSAL,r.Type.BITSTRING,false,String.fromCharCode(0)+z.subject.uniqueId)]))}if(z.extensions.length>0){y.value.push(j.certificateExtensionsToAsn1(z.extensions))}return y};j.getCertificationRequestInfo=function(z){var y=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.INTEGER,false,r.integerToDer(z.version).getBytes()),o(z.subject),j.publicKeyToAsn1(z.publicKey),x(z)]);return y};j.distinguishedNameToAsn1=function(y){return o(y)};j.certificateToAsn1=function(z){var y=z.tbsCertificate||j.getTBSCertificate(z);return r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[y,r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(z.signatureOid).getBytes()),w(z.signatureOid,z.signatureParameters)]),r.create(r.Class.UNIVERSAL,r.Type.BITSTRING,false,String.fromCharCode(0)+z.signature)])};j.certificateExtensionsToAsn1=function(A){var B=r.create(r.Class.CONTEXT_SPECIFIC,3,true,[]);var y=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[]);B.value.push(y);for(var z=0;z<A.length;++z){y.value.push(j.certificateExtensionToAsn1(A[z]))}return B};j.certificateExtensionToAsn1=function(z){var y=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[]);y.value.push(r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(z.id).getBytes()));if(z.critical){y.value.push(r.create(r.Class.UNIVERSAL,r.Type.BOOLEAN,false,String.fromCharCode(255)))}var A=z.value;if(typeof z.value!=="string"){A=r.toDer(A).getBytes()}y.value.push(r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,false,A));return y};j.certificationRequestToAsn1=function(z){var y=z.certificationRequestInfo||j.getCertificationRequestInfo(z);return r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[y,r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,true,[r.create(r.Class.UNIVERSAL,r.Type.OID,false,r.oidToDer(z.signatureOid).getBytes()),w(z.signatureOid,z.signatureParameters)]),r.create(r.Class.UNIVERSAL,r.Type.BITSTRING,false,String.fromCharCode(0)+z.signature)])};j.createCaStore=function(C){var B={certs:{}};B.getIssuer=function(D){var E=A(D.issuer);return E};B.addCertificate=function(E){if(typeof E==="string"){E=p.pki.certificateFromPem(E)}if(!E.subject.hash){var F=p.md.sha1.create();E.subject.attributes=j.RDNAttributesAsArray(o(E.subject),F);E.subject.hash=F.digest().toHex()}if(E.subject.hash in B.certs){var D=B.certs[E.subject.hash];if(!p.util.isArray(D)){D=[D]}D.push(E)}else{B.certs[E.subject.hash]=E}};B.hasCertificate=function(H){var F=A(H.subject);if(!F){return false}if(!p.util.isArray(F)){F=[F]}var E=r.toDer(j.certificateToAsn1(H)).getBytes();for(var G=0;G<F.length;++G){var D=r.toDer(j.certificateToAsn1(F[G])).getBytes();if(E===D){return true}}return false};function A(D){if(!D.hash){var E=p.md.sha1.create();D.attributes=j.RDNAttributesAsArray(o(D),E);D.hash=E.digest().toHex()}return B.certs[D.hash]||null}if(C){for(var z=0;z<C.length;++z){var y=C[z];B.addCertificate(y)}}return B};j.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};j.verifyCertificateChain=function(E,G,y){G=G.slice(0);var A=G.slice(0);var z=new Date();var C=true;var I=null;var S=0;do{var Q=G.shift();var D=null;var L=false;if(z<Q.validity.notBefore||z>Q.validity.notAfter){I={message:"Certificate is not valid yet or has expired.",error:j.certificateError.certificate_expired,notBefore:Q.validity.notBefore,notAfter:Q.validity.notAfter,now:z}}if(I===null){D=G[0]||E.getIssuer(Q);if(D===null){if(Q.isIssuer(Q)){L=true;D=Q}}if(D){var P=D;if(!p.util.isArray(P)){P=[P]}var H=false;while(!H&&P.length>0){D=P.shift();try{H=D.verify(Q)}catch(N){}}if(!H){I={message:"Certificate signature is invalid.",error:j.certificateError.bad_certificate}}}if(I===null&&(!D||L)&&!E.hasCertificate(Q)){I={message:"Certificate is not trusted.",error:j.certificateError.unknown_ca}}}if(I===null&&D&&!Q.isIssuer(D)){I={message:"Certificate issuer is invalid.",error:j.certificateError.bad_certificate}}if(I===null){var T={keyUsage:true,basicConstraints:true};for(var M=0;I===null&&M<Q.extensions.length;++M){var B=Q.extensions[M];if(B.critical&&!(B.name in T)){I={message:"Certificate has an unsupported critical extension.",error:j.certificateError.unsupported_certificate}}}}if(I===null&&(!C||(G.length===0&&(!D||L)))){var K=Q.getExtension("basicConstraints");var F=Q.getExtension("keyUsage");if(F!==null){if(!F.keyCertSign||K===null){I={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:j.certificateError.bad_certificate}}}if(I===null&&K!==null&&!K.cA){I={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:j.certificateError.bad_certificate}}if(I===null&&F!==null&&"pathLenConstraint" in K){var J=S-1;if(J>K.pathLenConstraint){I={message:"Certificate basicConstraints pathLenConstraint violated.",error:j.certificateError.bad_certificate}}}}var O=(I===null)?true:I.error;var R=y?y(O,S,A):O;if(R===true){I=null}else{if(O===true){I={message:"The application rejected the certificate.",error:j.certificateError.bad_certificate}}if(R||R===0){if(typeof R==="object"&&!p.util.isArray(R)){if(R.message){I.message=R.message}if(R.error){I.error=R.error}}else{if(typeof R==="string"){I.error=R}}}throw I}C=false;++S}while(G.length>0);return true}}var b="x509";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k.pki}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(i){var h=i.asn1;var g=i.pki=i.pki||{};g.pemToDer=function(j){var k=i.pem.decode(j)[0];if(k.procType&&k.procType.type==="ENCRYPTED"){throw new Error("Could not convert PEM to DER; PEM is encrypted.")}return i.util.createBuffer(k.body)};g.privateKeyFromPem=function(k){var m=i.pem.decode(k)[0];if(m.type!=="PRIVATE KEY"&&m.type!=="RSA PRIVATE KEY"){var j=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');j.headerType=m.type;throw j}if(m.procType&&m.procType.type==="ENCRYPTED"){throw new Error("Could not convert private key from PEM; PEM is encrypted.")}var l=h.fromDer(m.body);return g.privateKeyFromAsn1(l)};g.privateKeyToPem=function(j,l){var k={type:"RSA PRIVATE KEY",body:h.toDer(g.privateKeyToAsn1(j)).getBytes()};return i.pem.encode(k,{maxline:l})};g.privateKeyInfoToPem=function(j,l){var k={type:"PRIVATE KEY",body:h.toDer(j).getBytes()};return i.pem.encode(k,{maxline:l})}}var b="pki";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(n){n.aes=n.aes||{};n.aes.startEncrypting=function(w,v,u,x){var t=p({key:w,output:u,decrypt:false,mode:x});t.start(v);return t};n.aes.createEncryptionCipher=function(t,u){return p({key:t,output:null,decrypt:false,mode:u})};n.aes.startDecrypting=function(w,v,u,x){var t=p({key:w,output:u,decrypt:true,mode:x});t.start(v);return t};n.aes.createDecryptionCipher=function(t,u){return p({key:t,output:null,decrypt:true,mode:u})};n.aes.Algorithm=function(u,v){if(!q){j()}var t=this;t.name=u;t.mode=new v({blockSize:16,cipher:{encrypt:function(x,w){return h(t._w,x,w,false)},decrypt:function(x,w){return h(t._w,x,w,true)}}});t._init=false};n.aes.Algorithm.prototype.initialize=function(u){if(this._init){return}var x=u.key;var w;if(typeof x==="string"&&(x.length===16||x.length===24||x.length===32)){x=n.util.createBuffer(x)}else{if(n.util.isArray(x)&&(x.length===16||x.length===24||x.length===32)){w=x;x=n.util.createBuffer();for(var v=0;v<w.length;++v){x.putByte(w[v])}}}if(!n.util.isArray(x)){w=x;x=[];var t=w.length();if(t===16||t===24||t===32){t=t>>>2;for(var v=0;v<t;++v){x.push(w.getInt32())}}}if(!n.util.isArray(x)||!(x.length===4||x.length===6||x.length===8)){throw new Error("Invalid key parameter.")}var z=this.mode.name;var y=(["CFB","OFB","CTR","GCM"].indexOf(z)!==-1);this._w=s(x,u.decrypt&&!y);this._init=true};n.aes._expandKey=function(u,t){if(!q){j()}return s(u,t)};n.aes._updateBlock=h;o("AES-ECB",n.cipher.modes.ecb);o("AES-CBC",n.cipher.modes.cbc);o("AES-CFB",n.cipher.modes.cfb);o("AES-OFB",n.cipher.modes.ofb);o("AES-CTR",n.cipher.modes.ctr);o("AES-GCM",n.cipher.modes.gcm);function o(u,v){var t=function(){return new n.aes.Algorithm(u,v)};n.cipher.registerAlgorithm(u,t)}var q=false;var m=4;var k;var g;var i;var r;var l;function j(){q=true;i=[0,1,2,4,8,16,32,64,128,27,54];var E=new Array(256);for(var w=0;w<128;++w){E[w]=w<<1;E[w+128]=(w+128)<<1^283}k=new Array(256);g=new Array(256);r=new Array(4);l=new Array(4);for(var w=0;w<4;++w){r[w]=new Array(256);l[w]=new Array(256)}var z=0,v=0,C,A,x,D,t,B,y;for(var w=0;w<256;++w){D=v^(v<<1)^(v<<2)^(v<<3)^(v<<4);D=(D>>8)^(D&255)^99;k[z]=D;g[D]=z;t=E[D];C=E[z];A=E[C];x=E[A];B=(t<<24)^(D<<16)^(D<<8)^(D^t);y=(C^A^x)<<24^(z^x)<<16^(z^A^x)<<8^(z^C^x);for(var u=0;u<4;++u){r[u][z]=B;l[u][D]=y;B=B<<24|B>>>8;y=y<<24|y>>>8}if(z===0){z=v=1}else{z=C^E[E[E[C^x]]];v^=E[E[v]]}}}function s(G,v){var E=G.slice(0);var I,u=1;var z=E.length;var x=z+6+1;var A=m*x;for(var C=z;C<A;++C){I=E[C-1];if(C%z===0){I=k[I>>>16&255]<<24^k[I>>>8&255]<<16^k[I&255]<<8^k[I>>>24]^(i[u]<<24);u++}else{if(z>6&&(C%z===4)){I=k[I>>>24]<<24^k[I>>>16&255]<<16^k[I>>>8&255]<<8^k[I&255]}}E[C]=E[C-z]^I}if(v){var B;var K=l[0];var J=l[1];var H=l[2];var F=l[3];var D=E.slice(0);A=E.length;for(var C=0,t=A-m;C<A;C+=m,t-=m){if(C===0||C===(A-m)){D[C]=E[t];D[C+1]=E[t+3];D[C+2]=E[t+2];D[C+3]=E[t+1]}else{for(var y=0;y<m;++y){B=E[t+y];D[C+(3&-y)]=K[k[B>>>24]]^J[k[B>>>16&255]]^H[k[B>>>8&255]]^F[k[B&255]]}}}E=D}return E}function h(D,E,C,x){var z=D.length/4-1;var y,v,u,t,B;if(x){y=l[0];v=l[1];u=l[2];t=l[3];B=g}else{y=r[0];v=r[1];u=r[2];t=r[3];B=k}var L,K,I,H,M,A,F;L=E[0]^D[0];K=E[x?3:1]^D[1];I=E[2]^D[2];H=E[x?1:3]^D[3];var G=3;for(var J=1;J<z;++J){M=y[L>>>24]^v[K>>>16&255]^u[I>>>8&255]^t[H&255]^D[++G];A=y[K>>>24]^v[I>>>16&255]^u[H>>>8&255]^t[L&255]^D[++G];F=y[I>>>24]^v[H>>>16&255]^u[L>>>8&255]^t[K&255]^D[++G];H=y[H>>>24]^v[L>>>16&255]^u[K>>>8&255]^t[I&255]^D[++G];L=M;K=A;I=F}C[0]=(B[L>>>24]<<24)^(B[K>>>16&255]<<16)^(B[I>>>8&255]<<8)^(B[H&255])^D[++G];C[x?3:1]=(B[K>>>24]<<24)^(B[I>>>16&255]<<16)^(B[H>>>8&255]<<8)^(B[L&255])^D[++G];C[2]=(B[I>>>24]<<24)^(B[H>>>16&255]<<16)^(B[L>>>8&255]<<8)^(B[K&255])^D[++G];C[x?1:3]=(B[H>>>24]<<24)^(B[L>>>16&255]<<16)^(B[K>>>8&255]<<8)^(B[I&255])^D[++G]}function p(v){v=v||{};var w=(v.mode||"CBC").toUpperCase();var u="AES-"+w;var t;if(v.decrypt){t=n.cipher.createDecipher(u,v.key)}else{t=n.cipher.createCipher(u,v.key)}var x=t.start;t.start=function(A,z){var y=null;if(z instanceof n.util.ByteBuffer){y=z;z={}}z=z||{};z.output=y;z.iv=A;x.call(t,z)};return t}}var b="aes";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var f;var a=function(g,h){h.exports=function(k){var l=f.map(function(i){return g(i)}).concat(c);k=k||{};k.defined=k.defined||{};if(k.defined[b]){return k[b]}k.defined[b]=true;for(var j=0;j<l.length;++j){l[j](k)}return k[b]}};var e=define;define=function(h,g){f=(typeof h==="string")?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./cipher","./cipherModes","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();